/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.4.3
 * @license MIT
 */
const t="hashchange",e="popstate",n="route.changed",o=/:[^\/]+/g,a=/^\/(?=[^?]*)/,i=/\?.+/,r="Route string is not a pure route",c="$$",s=Array.isArray;function l(t){return"string"==typeof t?t.trim():""}function u(t){return t=l(`${t}`),!(["null","undefined",""].indexOf(t)>-1)&&!isNaN(Number(t))}function p(t){return t&&"object"==typeof t&&!s(t)}function h(t,e){return void 0===t?e:t}function f(t){return Array.prototype.slice.call(t)}function d(t){return"string"==typeof t&&a.test(t)}function _(t){return"string"==typeof t&&"#"===t.charAt(0)}function x(t){return"function"==typeof t}function v(t,e){return{type:t,state:{data:e}}}const g=window.location;function y(t,e){e=h(e,g.pathname);const n={};if(o.test(t)){const a=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(o.lastIndex=0,a.test(e)){const i=f(t.match(o)).map(t=>t.replace(":","")),r=f(e.match(a));r.shift(),i.forEach((t,e)=>{n[t]=r[e]})}}return n}function m(t){let e=[];return p(t)||s(t)?(Object.keys(t).forEach(n=>{!function t(e,n,o){let a=!1;p(o)||(a=s(o))?Object.keys(o).forEach(i=>{t(e,`${n}[${a?"":i}]`,o[i])}):["string","number","boolean","undefined","object"].indexOf(typeof o)>-1&&e.push(`${encodeURIComponent(n)}=${encodeURIComponent(o)}`)}(e,n,t[n])}),e.join("&")):"string"==typeof t?t:""}function w(t){return/\[/.test(t)}function $(t,e){t=l(h(t,g.search)),e=h(e,!1),"?"===t.charAt(0)&&(t=t.replace("?",""));const n=t.split("&"),o={};return t&&n.forEach(t=>{const n=t.split("=").map(t=>decodeURIComponent(t));w(n[0])?C.apply(this,[].concat(n).concat([o,e])):I.apply(this,[n,o,!1,e])}),o}function b(t,e){return void 0===t&&(t=[]),e?t:(o={},s(n=t)&&n.forEach((t,e)=>{o[e]=t}),o);var n,o}function S(t,e){return p(t)?{ob:t}:s(t)||void 0===t?{ob:b(t,u(e))}:{ob:[t],push:null!==t}}function C(t,e,n,o){o=h(o,!0);const a=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===a.length){let i=a[1],r=a[2];if(w(t=t.replace(/\[([^\[]*)\]/,"")))""===r&&(r="0"),C(t=t.replace(/[^\[]+/,r),e,n[i]=S(n[i],r).ob,o);else if(r){const t=S(n[i],r);n[i]=t.ob;const a=o?E(e):e;if(t.push){const t={};t[r]=a,n[i].push(t)}else n[i][r]=a}else I([a[1],e],n,!0)}}function I(t,e,n,o){o=h(o,!0);let a=t[0],i=t[1];o&&(i=E(i)),a in e?(e[a]=s(e[a])?e[a]:[e[a]],e[a].push(i)):e[a]=n?[i]:i}function E(t){if(null==t)return"";if("string"!=typeof t)return t;if(u(t=l(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function O(){return $.apply(this,arguments)}function k(t,e){p(t)&&Object.keys(t).forEach((function(n){e[n]=t[n]}))}function j(){const t=p(arguments[0])?arguments[0]:{};for(let e=1;e<arguments.length;e++)k(arguments[e],t);return t}function T(t){return t&&"object"==typeof t}function M(t,e){return void 0===t?e:t}function A(t){return"string"==typeof t?t.trim():""}function N(t,e){T(t)&&Object.keys(t).forEach((function(n){e[n]=t[n]}))}function D(t){try{return JSON.parse(t)}catch(e){return t}}const B=window.location,L=window.localStorage,R=window.sessionStorage,U=Object.prototype.hasOwnProperty,z="Thu, 31 Dec 2037 00:00:00 GMT",J="Thu, 01 Jan 1970 00:00:00 UTC",q=864e5,H=["localhost","0.0.0.0","127.0.0.1",null],F={SS:"sessionStorage",LS:"localStorage",CC:"cookie"};function P(t,e,n,o,a,i){if(t&&void 0!==e){o=M(o,"/"),a=M(a,B.hostname);let r=e;"object"==typeof e&&e&&(r=JSON.stringify(e));let c=new Date;"number"==typeof c&&(n===1/0?c=new Date(z):c.setTime(c.getTime()+n*q));const s=n?`; expires=${c.toUTCString()}`:"",l=`; path=${o.trim()}`,u=-1===H.indexOf(a)?`; domain=${a.trim()}`:"",p=("boolean"==typeof i&&i||void 0===i)&&"https:"===B.protocol?"; secure":"";document.cookie=`${t} = ${r}${s}${u}${l}${p}`}}function G(t,e){if(t){const n=decodeURIComponent(document.cookie);let o="";return function(t,e){if(t&&t.length)for(let n=0;n<t.length;n+=1)if("function"==typeof e){const o=e.apply(t,[t[n],n]);if("boolean"==typeof o){if(o)continue;break}}}(n.split(";"),n=>{const a=`${t}=`,i=n.indexOf(a);if(i>-1)return o=n.substring(i+a.length,n.length),e&&(o=A(o)),!1}),o}return""}function Q(t,e,n){const o=G.apply(this,[t]);if(t&&o.length){e=M(e,"/"),n=M(n,B.hostname);const o=-1===H.indexOf(n)?`; domain=${n.trim()}`:"",a=`${t}=; expires=${J}${o}; path=${e}`;return document.cookie=a,!A(G.apply(this,[t])).length}return!1}const K=String.fromCharCode;function V(t,e,n){if(U.call(t.context_dictionaryToCreate,t.context_w)){if(t.context_w.charCodeAt(0)<256){for(let o=0;o<t.context_numBits;o++)t.context_data_val=t.context_data_val<<1,t.context_data_position==e-1?(t.context_data_position=0,t.context_data.push(n(t.context_data_val)),t.context_data_val=0):t.context_data_position++;t.value=t.context_w.charCodeAt(0);for(let o=0;o<8;o++)t.context_data_val=t.context_data_val<<1|1&t.value,t.context_data_position==e-1?(t.context_data_position=0,t.context_data.push(n(t.context_data_val)),t.context_data_val=0):t.context_data_position++,t.value=t.value>>1}else{t.value=1;for(let o=0;o<t.context_numBits;o++)t.context_data_val=t.context_data_val<<1|t.value,t.context_data_position==e-1?(t.context_data_position=0,t.context_data.push(n(t.context_data_val)),t.context_data_val=0):t.context_data_position++,t.value=0;t.value=t.context_w.charCodeAt(0);for(let o=0;o<16;o++)t.context_data_val=t.context_data_val<<1|1&t.value,t.context_data_position==e-1?(t.context_data_position=0,t.context_data.push(n(t.context_data_val)),t.context_data_val=0):t.context_data_position++,t.value=t.value>>1}t.context_enlargeIn--,0==t.context_enlargeIn&&(t.context_enlargeIn=Math.pow(2,t.context_numBits),t.context_numBits++),delete t.context_dictionaryToCreate[t.context_w]}else{t.value=t.context_dictionary[t.context_w];for(let o=0;o<t.context_numBits;o++)t.context_data_val=t.context_data_val<<1|1&t.value,t.context_data_position==e-1?(t.context_data_position=0,t.context_data.push(n(t.context_data_val)),t.context_data_val=0):t.context_data_position++,t.value=t.value>>1}t.context_enlargeIn--,0==t.context_enlargeIn&&(t.context_enlargeIn=Math.pow(2,t.context_numBits),t.context_numBits++)}function W(t="",e,n){if(null===t)return"";const o={context_dictionary:{},context_dictionaryToCreate:{},context_data:[],context_c:"",context_wc:"",context_w:"",context_enlargeIn:2,context_dictSize:3,context_numBits:2,context_data_val:0,context_data_position:0};let a=0;for(let a=0;a<t.length;a+=1)o.context_c=t.charAt(a),U.call(o.context_dictionary,o.context_c)||(o.context_dictionary[o.context_c]=o.context_dictSize++,o.context_dictionaryToCreate[o.context_c]=!0),o.context_wc=o.context_w+o.context_c,U.call(o.context_dictionary,o.context_wc)?o.context_w=o.context_wc:(V(o,e,n),o.context_dictionary[o.context_wc]=o.context_dictSize++,o.context_w=String(o.context_c));for(""!==o.context_w&&V(o,e,n),o.value=2,a=0;a<o.context_numBits;a++)o.context_data_val=o.context_data_val<<1|1&o.value,o.context_data_position==e-1?(o.context_data_position=0,o.context_data.push(n(o.context_data_val)),o.context_data_val=0):o.context_data_position++,o.value=o.value>>1;for(;;){if(o.context_data_val=o.context_data_val<<1,o.context_data_position==e-1){o.context_data.push(n(o.context_data_val));break}o.context_data_position++}return o.context_data.join("")}function X(t=""){return null===W?"":""===W?null:function(t,e,n){const o=[],a={val:n(0),position:e,index:1},i=[];let r,c,s,l,u=4,p=4,h=3,f="";for(let t=0;t<3;t+=1)o[t]=t;let d=0,_=Math.pow(2,2),x=1;for(;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;switch(r=d){case 0:for(d=0,_=Math.pow(2,8),x=1;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;l=K(d);break;case 1:for(d=0,_=Math.pow(2,16),x=1;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;l=K(d);break;case 2:return""}for(o[3]=l,c=l,i.push(l);;){if(a.index>t)return"";for(d=0,_=Math.pow(2,h),x=1;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;switch(l=d){case 0:for(d=0,_=Math.pow(2,8),x=1;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;o[p++]=K(d),l=p-1,u--;break;case 1:for(d=0,_=Math.pow(2,16),x=1;x!==_;)s=a.val&a.position,a.position>>=1,0===a.position&&(a.position=e,a.val=n(a.index++)),d|=(s>0?1:0)*x,x<<=1;o[p++]=K(d),l=p-1,u--;break;case 2:return i.join("")}if(0===u&&(u=Math.pow(2,h),h++),o[l])f=o[l];else{if(l!==p)return null;f=c+c.charAt(0)}i.push(f),o[p++]=c+f.charAt(0),c=f,0===--u&&(u=Math.pow(2,h),h++)}}(t.length,16384,e=>t.charCodeAt(e)-32)}function Y(t,e,n){if(t&&void 0!==e)if("object"==typeof e&&e&&(e=JSON.stringify(e)),this.available){const o=n?R:L;try{o.setItem(t,this.config.compress?function(t=""){return null===t?"":W(t,15,t=>K(t+32))+" "}(e):e)}catch(o){P(t,e,n?void 0:1/0)}}else P(t,e,n?void 0:1/0)}function Z(t){const e=[];try{this.available&&[L,R].forEach(n=>{if(U.call(n,t)){const o=n.getItem(t);e.push({key:t,value:D(this.config.compress?X(o):o),type:F[n===L?"LS":"SS"]})}});const n=G(t);n&&e.push({key:t,value:D(n),type:F.CC})}catch(t){throw new TypeError(t.message)}return e}function tt(t){try{let e=!1;this.available&&([L,R].forEach(n=>{e=e||!!n.getItem(t)}),e&&[L,R].forEach(e=>{e.removeItem(t)}));const n=Q(t);return e||n}catch(e){return Q(t)}}const et=new class{constructor(t){this.config=Object.freeze(function(){let t=0;const e=T(arguments[0])?arguments[0]:{};for(t=1;t<arguments.length;t++)N(arguments[t],e);return e}({compress:!1},t)),this.available=function(){try{return L.setItem("test","test"),L.removeItem("test"),!0}catch(t){return!1}}()}set(){return Y.apply(this,arguments)}get(){const t=this.getAll.apply(this,arguments).filter(t=>!arguments[1]||t.type===F.SS);if(t.length>0)return t[0].value}getAll(){return Z.apply(this,arguments)}remove(){return tt.apply(this,arguments)}}({compress:!0}),nt={getDataFromStore:(t,e)=>j(et.get("routeStore"))[`${e?"#":""}${t}`],setDataToStore(t,e,n){let o=j(et.get("routeStore"));if(o[t]&&(!n||p(n)&&0===Object.keys(n).length))return!1;const a={};return a[`${e?"#":""}${t}`]=n,o=j({},o,a),et.set("routeStore",o,!0)},handlers:[],contains(t){return!!this.handlers.filter(t).length}};function ot(){const t=O();let e={};const n=g.hash.match(i);return n&&(e=j({},O(n[0]))),j({},t,e)}function at(t,e,n){n=j(n);const o=_(e),a=(e=e.substring(o?1:0)).split("?")[0];Object.keys(n).length&&nt.setDataToStore(a,o,n);const i=nt.getDataFromStore(a,o),r=y(t,e);return{hasMatch:Object.keys(r).length>0||d(e)&&(t===e||"*"===t),data:i,params:r}}function it(o){o.type=o.hash?t:e;const a=h(o.originalData,{});o.originalEvent=h(o.originalEvent,v(o.type,a)),delete o.originalData,function(t,e,n){n=j(n),nt.handlers.forEach(o=>{if(o.eventName===t){let t=o.route,a=e.hash?g.hash:g.pathname;o.isCaseInsensitive&&(t=t.toLowerCase(),a=a.toLowerCase());const{hasMatch:i,data:r,params:c}=at(t,a,n);i&&(!o.hash||o.hash&&e.hash)&&o.handler(j({},e,{data:r,params:c,query:ot()}))}})}(n,o,a)}function rt(t,e,n){let o=j({replaceMode:e,noTrigger:n},"string"==typeof t?{route:t}:t);if("string"==typeof o.route){const t=_(o.route),e=l(o.route).split("?");let n=e[0].substring(t?1:0),a=l(e[1]);if(a=m(a||l(o.queryString)),!d(n))throw new Error(r);{nt.setDataToStore(n,t,o.data);const e=function(t,e,n,o){return n=l(n.substring("?"===n.charAt(0)?1:0)),e?`${g.pathname}${g.search}#${t}${n?`?${n}`:""}`:o?`${t}${g.search}${n?`&${n}`:""}`:`${t}${n?`?${n}`:""}`}(n,t,a,o.appendQuery);history[o.replaceMode?"replaceState":"pushState"]({data:o.data},o.title,e),o.noTrigger||it({route:`${t?"#":""}${n}`,hash:t})}}}function ct(o,a,i){let r="string"==typeof o&&0===o.indexOf(c);if(x(o)&&(i=a,a=o,o="*"),s(o))return void function(t,e){nt.contains(t=>t.prevHandler===e)||ct(n=>{x(e)&&t.indexOf(`${n.hash?"#":""}${n.route.substring(n.hash?1:0)}`)>-1&&e.apply(this,[n])},e)}(o,a);const u=_(o=o.substring(r?c.length:0));o=o.substring(u?1:0),!nt.contains(t=>t.handler===a&&t.route===o)&&x(a)&&nt.handlers.push({eventName:n,handler:a,prevHandler:i,route:o,hash:u,caseIgnored:r,isCaseInsensitive:r}),(u?[g.hash]:[g.pathname,g.hash]).filter(t=>l(t)).forEach(n=>{let i=r?o.toLowerCase():o,c=r?n.toLowerCase():n;const s=_(n),l=at(i,c);if(l.hasMatch&&x(a)){const o=s?t:e;a({originalEvent:v(o,l.data),route:n,hash:s,eventName:o,data:l.data,params:l.params,query:ot(),caseIgnored:r,isCaseInsensitive:r})}})}function st(t,e){const n=nt.handlers.length;let o=s(t);const a=f(arguments);return 0===a.length?(nt.handlers.length=0,n):(o&&(t="*"),nt.handlers=nt.handlers.filter(n=>1!==a.length||"string"!=typeof t||o?(1===a.length&&x(t)&&(e=t,t="*"),!(n.route===t&&(n.handler===e||n.prevHandler===e))):n.route!==t),n-nt.handlers.length)}const lt={set(){return rt.apply(this,arguments)}};function ut(){return ct.apply(this,arguments)}function pt(t){"string"==typeof t&&ut.apply(this,[`${c}${t}`,f(arguments).slice(1)])}function ht(){return st.apply(this,arguments)}window.addEventListener(`${e}`,(function(t){const e=`${g.pathname}${g.hash}`.split("#"),n={originalEvent:t,originalData:j(t.state&&t.state.data)};it(j({},n,{route:e[0],hash:!1})),e[1]&&it(j({},n,{route:`#${e[1]}`,hash:!0}))}));export{O as deparam,m as param,ut as route,pt as routeIgnoreCase,y as routeParams,lt as router,ht as unroute};

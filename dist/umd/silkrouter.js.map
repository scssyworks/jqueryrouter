{"version":3,"file":"silkrouter.js","sources":["../../src/js/utils/constants.js","../../src/js/utils/getGlobal.js","../../src/js/utils/utils.js","../../src/js/utils/polyfills.js","../../src/js/utils/assign.js","../../src/js/utils/triggerEvent.js","../../src/js/api/routerEvent/index.js","../../src/js/api/collate/index.js","../../src/js/api/bindRouterEvents/index.js","../../src/js/utils/query.js","../../node_modules/is-number/index.js","../../src/js/utils/deparam.js","../../src/js/api/resolveQuery/index.js","../../src/js/api/set/index.js","../../src/js/api/callOnce/index.js","../../src/js/api/router/index.js","../../src/js/utils/params.js","../../src/js/operators/index.js"],"sourcesContent":["/**\n * Router constants\n */\nexport const POP_STATE = 'popstate';\nexport const REG_ROUTE_PARAMS = /:[^/]+/g;\nexport const REG_PATHNAME = /^\\/(?=[^?]*)/;\nexport const REG_COMPLEX = /\\[/;\nexport const REG_VARIABLE = /([^[]+)\\[([^[]*)\\]/;\nexport const REG_REPLACE_BRACKETS = /\\[([^[]*)\\]/;\nexport const REG_REPLACE_NEXTPROP = /[^[]+/;\nexport const HISTORY_UNSUPPORTED =\n  'Current browser does not support history object';\nexport const INVALID_ROUTE = 'Route string is not a pure route';\nexport const VIRTUAL_PUSHSTATE = 'vpushstate';\nexport const CACHED_FIELDS = [\n  'route',\n  'hashRouting',\n  'path',\n  'hash',\n  'search',\n  'hashSearch',\n  'data',\n];\nexport const AMP = '&';\nexport const QRY = '?';\nexport const EQ = '=';\nexport const EMPTY = '';\nexport const UNDEF = void 0;\nexport const TYPEOF_STR = typeof EMPTY;\nexport const TYPEOF_BOOL = typeof true;\nexport const TYPEOF_UNDEF = typeof UNDEF;\nexport const TYPEOF_OBJ = typeof {};\nexport const TYPEOF_NUM = typeof 0;\nexport const TYPEOF_FUNC = typeof (() => {});\nexport const STATE = 'State';\nexport const PUSH = `push${STATE}`;\nexport const REPLACE = `replace${STATE}`;\n","import { TYPEOF_UNDEF } from './constants';\n\nexport function getGlobal() {\n  return typeof globalThis !== TYPEOF_UNDEF ? globalThis : global || self;\n}\n","import {\n  EMPTY,\n  REG_PATHNAME,\n  TYPEOF_BOOL,\n  TYPEOF_FUNC,\n  TYPEOF_OBJ,\n  TYPEOF_STR,\n} from './constants';\n\n/**\n * Shorthand for Array.isArray\n */\nexport const isArr = Array.isArray;\n\n/**\n * Safely trims string\n * @param {string} str String\n */\nexport function trim(str) {\n  return typeof str === TYPEOF_STR ? str.trim() : EMPTY;\n}\n\n/**\n * Checks if value is an object\n * @param {*} value Any type of value\n */\nexport function isObject(value) {\n  return value && typeof value === TYPEOF_OBJ;\n}\n\n/**\n * Checks if key is a true object\n * @param {*} value Any type of value\n */\nexport function isPureObject(value) {\n  return isObject(value) && !isArr(value);\n}\n\n/**\n * Checks if given route is valid\n * @private\n * @param {string} route Route string\n */\nexport function isValidRoute(route) {\n  return typeof route === TYPEOF_STR && REG_PATHNAME.test(route);\n}\n\n/**\n * Checks if key is present in provided object\n * @param {object} ob Object\n * @param {*} key Key\n */\nexport function hasOwn(ob, key) {\n  return Object.prototype.hasOwnProperty.call(ob, key);\n}\n\n/**\n * Loops over an array like object\n * @param {object} arrayObj Array or array like object\n * @param {function} callback Callback function\n */\nexport function each(arrayObj, callback) {\n  if (arrayObj && arrayObj.length) {\n    for (let index = 0; index < arrayObj.length; index += 1) {\n      if (typeof callback === TYPEOF_FUNC) {\n        const continueTheLoop = callback.apply(arrayObj, [\n          arrayObj[index],\n          index,\n        ]);\n        if (typeof continueTheLoop === TYPEOF_BOOL) {\n          if (continueTheLoop) {\n            continue;\n          } else {\n            break;\n          }\n        }\n      }\n    }\n  }\n}\n","import { TYPEOF_UNDEF, UNDEF } from './constants';\nimport { getGlobal } from './getGlobal';\nimport { isArr } from './utils';\n\n// Polyfill custom event\nconst g = getGlobal();\nif (typeof g.CustomEvent === TYPEOF_UNDEF) {\n  const CustomEvent = function (event, params) {\n    params = params || { bubbles: false, cancelable: false, detail: UNDEF };\n    const evt = document.createEvent('CustomEvent');\n    evt.initCustomEvent(\n      event,\n      params.bubbles,\n      params.cancelable,\n      params.detail\n    );\n    return evt;\n  };\n\n  CustomEvent.prototype = g.Event.prototype;\n  g.CustomEvent = CustomEvent;\n}\n\n// Polyfill Array.from\n\nif (!Array.from) {\n  Array.from = function (arrayLike) {\n    if (isArr(arrayLike)) {\n      return arrayLike;\n    }\n    const arr = [];\n    for (let i = 0; i < arrayLike.length; i++) {\n      arr.push(arrayLike[i]);\n    }\n    return arr;\n  };\n}\n","import { isObject } from './utils';\n\n/**\n * Inner loop function for assign\n * @private\n * @param {object} ref Argument object\n * @param {object} target First object\n */\nfunction loopFunc(ref, target) {\n  if (isObject(ref)) {\n    Object.keys(ref).forEach(function (key) {\n      target[key] = ref[key];\n    });\n  }\n}\n\n/**\n * Polyfill for Object.assign only smaller and with less features\n * @private\n * @returns {object}\n */\nexport function assign(...args) {\n  const target = isObject(args[0]) ? args[0] : {};\n  for (let i = 1; i < args.length; i++) {\n    loopFunc(args[i], target);\n  }\n  return target;\n}\n","import { TYPEOF_STR } from './constants';\nimport { getGlobal } from './getGlobal';\nimport { each } from './utils';\n\nconst g = getGlobal();\n\n// Internal function\nfunction isValidTarget(target) {\n  return (\n    target instanceof NodeList ||\n    target instanceof HTMLCollection ||\n    Array.isArray(target)\n  );\n}\n\n/**\n * Function to trigger custom event\n * @param {Node|NodeList|HTMLCollection|Node[]} target Target element or list\n * @param {string} eventType Event type\n * @param {any[]} data Data to be passed to handler\n */\nexport function trigger(target, eventType, data) {\n  if (target instanceof Node) {\n    target = [target];\n  }\n  if (isValidTarget(target) && typeof eventType === TYPEOF_STR) {\n    each(target, (el) => {\n      const customEvent = new g.CustomEvent(eventType, {\n        bubbles: true,\n        cancelable: true,\n        detail: data || [],\n      });\n      el.dispatchEvent(customEvent);\n    });\n  }\n}\n","import { QRY } from '../../utils/constants';\nimport { trim } from '../../utils/utils';\nexport default class RouterEvent {\n  constructor(routeInfo, currentEvent) {\n    // Set relevant parameters\n    const routeObject = routeInfo[0];\n    const originalEvent = routeInfo[1];\n    const routerInstance = routeInfo[2];\n    const { location, history } = routerInstance.config;\n    this.route = routeObject.path;\n    this.hashRouting = routeObject.hash;\n    this.routerInstance = routerInstance;\n    this.virtualEvent = currentEvent || {};\n    this.originalEvent = originalEvent || {};\n    this.path = trim(location.pathname);\n    this.hash = location.hash;\n    this.search = trim(location.search.substring(1));\n    this.hashSearch = trim(location.hash && location.hash.split(QRY)[1]);\n    const { state } = this.originalEvent;\n    this.data = (state && state.data) || (history.state && history.state.data);\n  }\n}\n","import { Observable } from 'rxjs';\nimport RouterEvent from '../routerEvent';\n\nexport default function collate() {\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next: (event) => {\n          const routerInstance = event.detail[2];\n          if (routerInstance === this) {\n            subscriber.next(new RouterEvent(event.detail, event));\n          }\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n","import { fromEvent } from 'rxjs';\nimport { POP_STATE, QRY, VIRTUAL_PUSHSTATE } from '../../utils/constants';\nimport { trigger } from '../../utils/triggerEvent';\nimport collate from '../collate';\nimport { trim } from '../../utils/utils';\nimport { getGlobal } from '../../utils/getGlobal';\n\nexport default function bindRouterEvents() {\n  const { context, location, hashRouting } = this.config;\n  this.popStateSubscription = fromEvent(getGlobal(), POP_STATE).subscribe(\n    (e) => {\n      const path = trim(\n        hashRouting\n          ? location.hash.substring(1).split(QRY)[0]\n          : location.pathname\n      );\n      if (path) {\n        trigger(context, VIRTUAL_PUSHSTATE, [\n          { path, hash: hashRouting },\n          e,\n          this,\n        ]);\n      }\n    }\n  );\n  this.listeners = fromEvent(context, VIRTUAL_PUSHSTATE).pipe(\n    collate.apply(this)\n  );\n  if (hashRouting && !location.hash) {\n    this.set('/', true, false); // Replace current hash path without executing anythings\n  }\n}\n","import { AMP, EMPTY, TYPEOF_FUNC, TYPEOF_STR } from './constants';\nimport { isArr, isObject } from './utils';\n\n/**\n * Builds query string recursively\n * @private\n * @param {string[]} qsList List of query string key value pairs\n * @param {*} key Key\n * @param {*} obj Value\n */\nfunction buildQuery(qsList, key, obj) {\n  if (isObject(obj)) {\n    Object.keys(obj).forEach((obKey) => {\n      buildQuery(qsList, `${key}[${isArr(obj) ? EMPTY : obKey}]`, obj[obKey]);\n    });\n  } else if (typeof obj !== TYPEOF_FUNC) {\n    qsList.push(`${encodeURIComponent(key)}=${encodeURIComponent(obj)}`);\n  }\n}\n\n/**\n * Converts an object to a query string\n * @private\n * @param {object} obj Object which should be converted to a string\n * @returns {string}\n */\nexport function toQueryString(obj) {\n  let qsList = [];\n  if (isObject(obj)) {\n    Object.keys(obj).forEach((key) => {\n      buildQuery(qsList, key, obj[key]);\n    });\n    return qsList.join(AMP);\n  }\n  return typeof obj === TYPEOF_STR ? obj : EMPTY;\n}\n","/*!\n * is-number <https://github.com/jonschlinkert/is-number>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(num) {\n  if (typeof num === 'number') {\n    return num - num === 0;\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isFinite ? Number.isFinite(+num) : isFinite(+num);\n  }\n  return false;\n};\n","import isNumber from 'is-number';\nimport { isArr, trim, isPureObject } from './utils';\nimport {\n  REG_COMPLEX,\n  REG_VARIABLE,\n  REG_REPLACE_BRACKETS,\n  REG_REPLACE_NEXTPROP,\n  TYPEOF_UNDEF,\n  UNDEF,\n  TYPEOF_STR,\n  EMPTY,\n  AMP,\n  QRY,\n  EQ,\n} from './constants';\n\n/**\n * Checks if query parameter key is a complex notation\n * @param {string} q\n */\nfunction ifComplex(q) {\n  return REG_COMPLEX.test(q);\n}\n\n/**\n * Converts query string to JavaScript object\n * @param {string} qs query string argument (defaults to url query string)\n */\nfunction lib(qs, coerce) {\n  qs = trim(qs);\n  if (qs.charAt(0) === QRY) {\n    qs = qs.replace(QRY, EMPTY);\n  }\n  const queryObject = Object.create(null);\n  if (qs) {\n    qs.split(AMP).forEach((qq) => {\n      const qArr = qq.split(EQ).map((part) => decodeURIComponent(part));\n      (ifComplex(qArr[0]) ? complex : simple).apply(\n        this,\n        qArr.concat([queryObject, coerce, false])\n      );\n    });\n  }\n  return queryObject;\n}\n\n/**\n * Converts an array to an object\n * @param {array} arr\n */\nfunction toObject(arr) {\n  var convertedObj = Object.create(null);\n  if (isArr(arr)) {\n    arr.forEach((value, index) => {\n      convertedObj[index] = value;\n    });\n  }\n  return convertedObj;\n}\n\n/**\n * Resolves an array to object if required\n * @param {array} ob An array object\n * @param {boolean} isNumber flag to test if next key is number\n */\nfunction resolve(ob, isNextNumber) {\n  return isNextNumber ? (typeof ob === TYPEOF_UNDEF ? [] : ob) : toObject(ob);\n}\n\n/**\n * Resolves the target object for next iteration\n * @param {Object} ob current reference object\n * @param {string} nextProp reference property in current object\n */\nfunction resolveObj(ob, nextProp) {\n  if (isPureObject(ob)) return { ob };\n  if (isArr(ob) || typeof ob === TYPEOF_UNDEF)\n    return { ob: resolve(ob, isNumber(nextProp)) };\n  return { ob: [ob], push: ob !== null };\n}\n\n/**\n * Handles complex query parameters\n * @param {string} key\n * @param {string} value\n * @param {Object} obj\n */\nfunction complex(key, value, obj, coercion) {\n  const match = key.match(REG_VARIABLE) || [];\n  if (match.length === 3) {\n    const prop = match[1];\n    let nextProp = match[2];\n    key = key.replace(REG_REPLACE_BRACKETS, EMPTY);\n    if (ifComplex(key)) {\n      if (nextProp === EMPTY) nextProp = '0';\n      key = key.replace(REG_REPLACE_NEXTPROP, nextProp);\n      complex(\n        key,\n        value,\n        (obj[prop] = resolveObj(obj[prop], nextProp).ob),\n        coercion\n      );\n    } else if (nextProp) {\n      const resolved = resolveObj(obj[prop], nextProp);\n      obj[prop] = resolved.ob;\n      const coercedValue = coercion ? coerce(value) : value;\n      if (resolved.push) {\n        obj[prop].push({\n          [nextProp]: coercedValue,\n        });\n      } else {\n        obj[prop][nextProp] = coercedValue;\n      }\n    } else {\n      simple(prop, value, obj, coercion, true);\n    }\n  }\n}\n\n/**\n * Handles simple query\n * @param {array} qArr\n * @param {Object} queryObject\n * @param {boolean} toArray\n */\nfunction simple(key, value, queryObject, coercion, toArray) {\n  if (coercion) {\n    value = coerce(value);\n  }\n  if (key in queryObject) {\n    queryObject[key] = isArr(queryObject[key])\n      ? queryObject[key]\n      : [queryObject[key]];\n    queryObject[key].push(value);\n  } else {\n    queryObject[key] = toArray ? [value] : value;\n  }\n}\n\n/**\n * Restores values to their original type\n * @param {string} value undefined or string value\n */\nfunction coerce(value) {\n  if (value == null) return EMPTY;\n  if (typeof value !== TYPEOF_STR) return value;\n  if (isNumber((value = trim(value)))) return +value;\n  switch (value) {\n    case 'null':\n      return null;\n    case TYPEOF_UNDEF:\n      return UNDEF;\n    case 'true':\n      return true;\n    case 'false':\n      return false;\n    case 'NaN':\n      return NaN;\n    default:\n      return value;\n  }\n}\n\nexport { lib as deparam };\n","import { trim } from '../../utils/utils';\nimport { toQueryString } from '../../utils/query';\nimport { assign } from '../../utils/assign';\nimport { deparam } from '../../utils/deparam';\nimport { QRY } from '../../utils/constants';\n\n/**\n * Resolves and analyzes existing query string\n * @private\n * @param {string} queryString Query string\n * @param {string} hashRouting Flag to test if hash routing is enabled\n */\nexport default function resolveQuery(queryString, hashRouting) {\n  const { location } = this.config;\n  const search = trim(location.search && location.search.substring(1));\n  const existingQuery = hashRouting\n    ? trim(location.hash.split(QRY)[1])\n    : trim(search);\n  if (!existingQuery) return queryString;\n  return toQueryString(\n    assign(deparam(search), deparam(existingQuery), deparam(queryString))\n  );\n}\n","import { trigger } from '../../utils/triggerEvent';\nimport {\n  VIRTUAL_PUSHSTATE,\n  INVALID_ROUTE,\n  UNDEF,\n  TYPEOF_STR,\n  EMPTY,\n  QRY,\n  REPLACE,\n  PUSH,\n} from '../../utils/constants';\nimport { isValidRoute, trim, isObject } from '../../utils/utils';\nimport { toQueryString } from '../../utils/query';\nimport resolveQuery from '../resolveQuery';\nimport { assign } from '../../utils/assign';\n\nexport default function set(route, replace, exec) {\n  exec = exec || true;\n  const { preservePath, hashRouting, history } = this.config;\n  const routeObject = assign(\n    { replace, exec },\n    typeof route === TYPEOF_STR ? { route } : route\n  );\n  replace = routeObject.replace;\n  exec = routeObject.exec;\n  let { route: routeStr, queryString } = routeObject;\n  const { preserveQuery, data, pageTitle = null } = routeObject;\n  const routeParts = routeStr.split(QRY);\n  // Check if query string is an object\n  if (isObject(queryString)) {\n    queryString = toQueryString(queryString);\n  }\n  // Resolve to URL query string if it's not explicitly passed\n  queryString = trim(queryString ? queryString : routeParts[1]);\n  routeStr = trim(routeParts[0]);\n  // Check if query preservation is required. Resolve query accordingly\n  if (preserveQuery) {\n    queryString = resolveQuery.apply(this, [queryString, hashRouting]);\n  }\n  if (isValidRoute(routeStr)) {\n    const unmodifiedRoute = routeStr;\n    if (hashRouting) {\n      routeStr = `/#${routeStr}`;\n      // Path preservation should only work for hash routing\n      if (preservePath) {\n        routeStr = `${routeStr.substring(1)}`;\n      }\n    }\n    // Append query string\n    routeStr = `${routeStr}${queryString ? `${QRY + queryString}` : EMPTY}`;\n    history[replace ? REPLACE : PUSH]({ data }, pageTitle, routeStr);\n    if (exec && unmodifiedRoute) {\n      trigger(this.config.context, VIRTUAL_PUSHSTATE, [\n        {\n          path: unmodifiedRoute,\n          hash: hashRouting,\n        },\n        UNDEF,\n        this,\n      ]);\n    }\n  } else {\n    throw new TypeError(INVALID_ROUTE);\n  }\n  return this;\n}\n","import { Observable } from 'rxjs';\nimport { QRY, UNDEF } from '../../utils/constants';\nimport { trim } from '../../utils/utils';\nimport RouterEvent from '../routerEvent';\n\nexport default function callOnce(isDone) {\n  const { hashRouting: hash, location } = this.config;\n  const path = trim(\n    hash ? location.hash.substring(1).split(QRY)[0] : location.pathname\n  );\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe(subscriber);\n      if (!isDone) {\n        isDone = true;\n        if (path) {\n          subscriber.next(new RouterEvent([{ path, hash }, UNDEF, this]));\n        }\n      }\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n","import { assign } from '../../utils/assign';\nimport bindRouterEvents from '../bindRouterEvents';\nimport set from '../set';\nimport { HISTORY_UNSUPPORTED, PUSH, TYPEOF_FUNC } from '../../utils/constants';\nimport callOnce from '../callOnce';\nimport { getGlobal } from '../../utils/getGlobal';\n\nexport default class Router {\n  constructor(config = {}) {\n    const { history, location, document } = getGlobal();\n    if (!history[PUSH]) {\n      throw new Error(HISTORY_UNSUPPORTED);\n    }\n    config = assign(\n      {\n        hashRouting: false, // Switch to hash routing\n        preservePath: false, // Works for hash routing\n        context: document.body, // To change the context of \"vpushstate\" event\n        location, // Should remain unchanged\n        history, // History object\n      },\n      config\n    );\n    this.config = Object.freeze(config);\n    this.__paths__ = [];\n    bindRouterEvents.apply(this);\n  }\n  pipe(...ops) {\n    return this.listeners.pipe(callOnce.apply(this), ...ops);\n  }\n  subscribe(...fns) {\n    return this.listeners.pipe(callOnce.apply(this)).subscribe(...fns);\n  }\n  set(...props) {\n    return set.apply(this, props);\n  }\n  destroy(callback) {\n    if (typeof callback === TYPEOF_FUNC) {\n      callback();\n    }\n    this.popStateSubscription.unsubscribe(); // Unsubscribe popstate event\n    this.__paths__.length = 0;\n  }\n}\n","import { EMPTY, REG_ROUTE_PARAMS } from './constants';\n\n/**\n * Parses current path and returns params object\n * @private\n * @param {string} expr Route expression\n * @param {string} path URL path\n * @returns {object}\n */\nexport function extractParams(expr, path) {\n  const params = {};\n  if (REG_ROUTE_PARAMS.test(expr)) {\n    const pathRegex = new RegExp(\n      expr.replace(/\\//g, '\\\\/').replace(/:[^/\\\\]+/g, '([^\\\\/]+)')\n    );\n    REG_ROUTE_PARAMS.lastIndex = 0;\n    if (pathRegex.test(path)) {\n      const keys = Array.from(expr.match(REG_ROUTE_PARAMS)).map((key) =>\n        key.replace(':', EMPTY)\n      );\n      const values = Array.from(path.match(pathRegex));\n      values.shift();\n      keys.forEach((key, index) => {\n        params[key] = values[index];\n      });\n    }\n  }\n  return params;\n}\n","import { trim, isValidRoute, each, isObject } from '../utils/utils';\nimport { Observable } from 'rxjs';\nimport {\n  INVALID_ROUTE,\n  CACHED_FIELDS,\n  UNDEF,\n  TYPEOF_BOOL,\n} from '../utils/constants';\nimport { extractParams } from '../utils/params';\nimport { deparam as queryDeparam } from '../utils/deparam';\nimport Router from '../api/router';\nimport { assign } from '../utils/assign';\n\n/**\n * Operator to compare a specific route\n * @param {string} routeStr Route string\n * @param {Router} routerInstance Current router object [optional]\n * @param {boolean} ignoreCase Ignore case in route string\n */\nexport function route(routeStr, routerInstance, ignoreCase) {\n  if (typeof routerInstance === TYPEOF_BOOL) {\n    ignoreCase = routerInstance;\n    routerInstance = UNDEF;\n  }\n  routeStr = trim(routeStr);\n  if (routerInstance instanceof Router) {\n    const paths = routerInstance.__paths__;\n    if (paths.indexOf(routeStr) === -1) {\n      paths.push(routeStr);\n    }\n  }\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next(event) {\n          let incomingRoute = event.route;\n          if (isValidRoute(routeStr)) {\n            if (ignoreCase) {\n              routeStr = routeStr.toLowerCase();\n              incomingRoute = incomingRoute.toLowerCase();\n            }\n            const params = extractParams(routeStr, incomingRoute);\n            const paramsLength = Object.keys(params).length;\n            if (incomingRoute === routeStr || paramsLength > 0) {\n              if (paramsLength > 0) {\n                event.params = params;\n              }\n              subscriber.next(event);\n            }\n          } else {\n            subscriber.error(new Error(INVALID_ROUTE));\n          }\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        if (routerInstance instanceof Router) {\n          const paths = routerInstance.__paths__;\n          const existingRouteIndex = paths.indexOf(routeStr);\n          if (existingRouteIndex > -1) {\n            paths.splice(existingRouteIndex, 1);\n          }\n        }\n        subn.unsubscribe();\n      };\n    });\n}\n\n/**\n * Converts search and hashSearch strings to object\n * @param {boolean} coerce Flag to enable value typecast\n */\nexport function deparam(coerce) {\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next(event) {\n          try {\n            event.search = queryDeparam(event.search, coerce);\n            event.hashSearch = queryDeparam(event.hashSearch, coerce);\n            subscriber.next(event);\n          } catch (e) {\n            subscriber.error(e);\n          }\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n\n/**\n * Modifies current subscriber to detect errors\n * @param {Router} routerInstance Current router object\n */\nexport function noMatch(routerInstance) {\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next(event) {\n          if (routerInstance instanceof Router) {\n            const paths = routerInstance.__paths__;\n            if (paths.length > 0) {\n              const currentRoute = event.route;\n              let match = false;\n              for (let i = 0; i < paths.length; i++) {\n                if (\n                  paths[i] === currentRoute ||\n                  Object.keys(extractParams(paths[i], currentRoute)).length\n                ) {\n                  match = true;\n                  break;\n                }\n              }\n              if (!match) {\n                event.noMatch = true;\n                subscriber.next(event);\n              }\n            }\n          }\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        subn.unsubscribe();\n      };\n    });\n}\n\nfunction deepComparison(first, second, result) {\n  each(Object.keys(first), (key) => {\n    if (isObject(first[key]) && isObject(second[key])) {\n      deepComparison(first[key], second[key], result);\n    } else {\n      result.break = first[key] !== second[key];\n    }\n  });\n}\n\n/**\n * Caches incoming routes to avoid calling handler if there is no change\n * @param {string[]} keys\n * @param {boolean} deep\n */\nexport function cache(keys = CACHED_FIELDS, deep) {\n  let cache = {};\n  if (typeof keys === TYPEOF_BOOL) {\n    deep = keys;\n    keys = CACHED_FIELDS;\n  }\n  return (observable) =>\n    new Observable((subscriber) => {\n      const subn = observable.subscribe({\n        next(event) {\n          each(keys, (key) => {\n            if (deep && isObject(event[key]) && isObject(cache[key])) {\n              const result = {};\n              deepComparison(event[key], cache[key], result);\n              if (result.break) {\n                assign(cache, event);\n                subscriber.next(event);\n                return false;\n              }\n            } else if (event[key] !== cache[key]) {\n              assign(cache, event);\n              subscriber.next(event);\n              return false; // break loop\n            }\n          });\n        },\n        error: subscriber.error,\n        complete: subscriber.complete,\n      });\n      return () => {\n        subn.unsubscribe();\n        cache = {};\n      };\n    });\n}\n"],"names":["POP_STATE","REG_ROUTE_PARAMS","REG_PATHNAME","REG_COMPLEX","REG_VARIABLE","REG_REPLACE_BRACKETS","REG_REPLACE_NEXTPROP","HISTORY_UNSUPPORTED","INVALID_ROUTE","VIRTUAL_PUSHSTATE","CACHED_FIELDS","AMP","QRY","EQ","EMPTY","UNDEF","TYPEOF_STR","TYPEOF_BOOL","TYPEOF_UNDEF","TYPEOF_OBJ","TYPEOF_FUNC","STATE","PUSH","REPLACE","getGlobal","globalThis","global","self","isArr","Array","isArray","trim","str","isObject","value","isPureObject","isValidRoute","route","test","each","arrayObj","callback","length","index","continueTheLoop","apply","g","CustomEvent","event","params","bubbles","cancelable","detail","evt","document","createEvent","initCustomEvent","prototype","Event","from","arrayLike","arr","i","push","loopFunc","ref","target","Object","keys","forEach","key","assign","isValidTarget","NodeList","HTMLCollection","trigger","eventType","data","Node","el","customEvent","dispatchEvent","RouterEvent","routeInfo","currentEvent","routeObject","originalEvent","routerInstance","config","location","history","path","hashRouting","hash","virtualEvent","pathname","search","substring","hashSearch","split","state","collate","observable","Observable","subscriber","subn","subscribe","next","error","complete","unsubscribe","bindRouterEvents","context","popStateSubscription","fromEvent","e","listeners","pipe","set","buildQuery","qsList","obj","obKey","encodeURIComponent","toQueryString","join","ifComplex","q","lib","qs","coerce","charAt","replace","queryObject","create","qq","qArr","map","part","decodeURIComponent","complex","simple","concat","toObject","convertedObj","resolve","ob","isNextNumber","resolveObj","nextProp","isNumber","coercion","match","prop","resolved","coercedValue","toArray","NaN","resolveQuery","queryString","existingQuery","deparam","exec","preservePath","routeStr","preserveQuery","pageTitle","routeParts","unmodifiedRoute","TypeError","callOnce","isDone","Router","Error","body","freeze","__paths__","ops","props","extractParams","expr","pathRegex","RegExp","lastIndex","values","shift","ignoreCase","paths","indexOf","incomingRoute","toLowerCase","paramsLength","existingRouteIndex","splice","queryDeparam","noMatch","currentRoute","deepComparison","first","second","result","cache","deep"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACO,IAAMA,SAAS,GAAG,UAAlB;EACA,IAAMC,gBAAgB,GAAG,SAAzB;EACA,IAAMC,YAAY,GAAG,cAArB;EACA,IAAMC,WAAW,GAAG,IAApB;EACA,IAAMC,YAAY,GAAG,oBAArB;EACA,IAAMC,oBAAoB,GAAG,aAA7B;EACA,IAAMC,oBAAoB,GAAG,OAA7B;EACA,IAAMC,mBAAmB,GAC9B,iDADK;EAEA,IAAMC,aAAa,GAAG,kCAAtB;EACA,IAAMC,iBAAiB,GAAG,YAA1B;EACA,IAAMC,aAAa,GAAG,CAC3B,OAD2B,EAE3B,aAF2B,EAG3B,MAH2B,EAI3B,MAJ2B,EAK3B,QAL2B,EAM3B,YAN2B,EAO3B,MAP2B,CAAtB;EASA,IAAMC,GAAG,GAAG,GAAZ;EACA,IAAMC,GAAG,GAAG,GAAZ;EACA,IAAMC,EAAE,GAAG,GAAX;EACA,IAAMC,KAAK,GAAG,EAAd;EACA,IAAMC,KAAK,GAAG,KAAK,CAAnB;EACA,IAAMC,UAAU,WAAUF,KAAV,CAAhB;EACA,IAAMG,WAAW,WAAU,IAAV,CAAjB;EACA,IAAMC,YAAY,WAAUH,KAAV,CAAlB;EACA,IAAMI,UAAU,WAAU,EAAV,CAAhB;UAC0B,CAAV;EAChB,IAAMC,WAAW,WAAW,YAAM,EAAjB,CAAjB;EACA,IAAMC,KAAK,GAAG,OAAd;EACA,IAAMC,IAAI,iBAAUD,KAAV,CAAV;EACA,IAAME,OAAO,oBAAaF,KAAb,CAAb;;EClCA,SAASG,SAAT,GAAqB;EAC1B,SAAO,QAAOC,UAAP,yCAAOA,UAAP,OAAsBP,YAAtB,GAAqCO,UAArC,GAAkDC,MAAM,IAAIC,IAAnE;EACD;;ECKD;EACA;EACA;;EACO,IAAMC,KAAK,GAAGC,KAAK,CAACC,OAApB;EAEP;EACA;EACA;EACA;;EACO,SAASC,IAAT,CAAcC,GAAd,EAAmB;EACxB,SAAO,QAAOA,GAAP,MAAehB,UAAf,GAA4BgB,GAAG,CAACD,IAAJ,EAA5B,GAAyCjB,KAAhD;EACD;EAED;EACA;EACA;EACA;;EACO,SAASmB,QAAT,CAAkBC,KAAlB,EAAyB;EAC9B,SAAOA,KAAK,IAAI,QAAOA,KAAP,MAAiBf,UAAjC;EACD;EAED;EACA;EACA;EACA;;EACO,SAASgB,YAAT,CAAsBD,KAAtB,EAA6B;EAClC,SAAOD,QAAQ,CAACC,KAAD,CAAR,IAAmB,CAACN,KAAK,CAACM,KAAD,CAAhC;EACD;EAED;EACA;EACA;EACA;EACA;;EACO,SAASE,YAAT,CAAsBC,KAAtB,EAA6B;EAClC,SAAO,QAAOA,KAAP,MAAiBrB,UAAjB,IAA+Bd,YAAY,CAACoC,IAAb,CAAkBD,KAAlB,CAAtC;EACD;EAWD;EACA;EACA;EACA;EACA;;EACO,SAASE,IAAT,CAAcC,QAAd,EAAwBC,QAAxB,EAAkC;EACvC,MAAID,QAAQ,IAAIA,QAAQ,CAACE,MAAzB,EAAiC;EAC/B,SAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGH,QAAQ,CAACE,MAArC,EAA6CC,KAAK,IAAI,CAAtD,EAAyD;EACvD,UAAI,QAAOF,QAAP,MAAoBrB,WAAxB,EAAqC;EACnC,YAAMwB,eAAe,GAAGH,QAAQ,CAACI,KAAT,CAAeL,QAAf,EAAyB,CAC/CA,QAAQ,CAACG,KAAD,CADuC,EAE/CA,KAF+C,CAAzB,CAAxB;;EAIA,YAAI,QAAOC,eAAP,MAA2B3B,WAA/B,EAA4C;EAC1C,cAAI2B,eAAJ,EAAqB;EACnB;EACD,WAFD,MAEO;EACL;EACD;EACF;EACF;EACF;EACF;EACF;;EC1ED,IAAME,GAAC,GAAGtB,SAAS,EAAnB;;EACA,IAAI,QAAOsB,GAAC,CAACC,WAAT,MAAyB7B,YAA7B,EAA2C;EACzC,MAAM6B,WAAW,GAAG,SAAdA,WAAc,CAAUC,KAAV,EAAiBC,MAAjB,EAAyB;EAC3CA,IAAAA,MAAM,GAAGA,MAAM,IAAI;EAAEC,MAAAA,OAAO,EAAE,KAAX;EAAkBC,MAAAA,UAAU,EAAE,KAA9B;EAAqCC,MAAAA,MAAM,EAAErC;EAA7C,KAAnB;EACA,QAAMsC,GAAG,GAAGC,QAAQ,CAACC,WAAT,CAAqB,aAArB,CAAZ;EACAF,IAAAA,GAAG,CAACG,eAAJ,CACER,KADF,EAEEC,MAAM,CAACC,OAFT,EAGED,MAAM,CAACE,UAHT,EAIEF,MAAM,CAACG,MAJT;EAMA,WAAOC,GAAP;EACD,GAVD;;EAYAN,EAAAA,WAAW,CAACU,SAAZ,GAAwBX,GAAC,CAACY,KAAF,CAAQD,SAAhC;EACAX,EAAAA,GAAC,CAACC,WAAF,GAAgBA,WAAhB;EACD;;;EAID,IAAI,CAAClB,KAAK,CAAC8B,IAAX,EAAiB;EACf9B,EAAAA,KAAK,CAAC8B,IAAN,GAAa,UAAUC,SAAV,EAAqB;EAChC,QAAIhC,KAAK,CAACgC,SAAD,CAAT,EAAsB;EACpB,aAAOA,SAAP;EACD;;EACD,QAAMC,GAAG,GAAG,EAAZ;;EACA,SAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAAClB,MAA9B,EAAsCoB,CAAC,EAAvC,EAA2C;EACzCD,MAAAA,GAAG,CAACE,IAAJ,CAASH,SAAS,CAACE,CAAD,CAAlB;EACD;;EACD,WAAOD,GAAP;EACD,GATD;EAUD;;EClCD;EACA;EACA;EACA;EACA;EACA;;EACA,SAASG,QAAT,CAAkBC,GAAlB,EAAuBC,MAAvB,EAA+B;EAC7B,MAAIjC,QAAQ,CAACgC,GAAD,CAAZ,EAAmB;EACjBE,IAAAA,MAAM,CAACC,IAAP,CAAYH,GAAZ,EAAiBI,OAAjB,CAAyB,UAAUC,GAAV,EAAe;EACtCJ,MAAAA,MAAM,CAACI,GAAD,CAAN,GAAcL,GAAG,CAACK,GAAD,CAAjB;EACD,KAFD;EAGD;EACF;EAED;EACA;EACA;EACA;EACA;;;EACO,SAASC,MAAT,GAAyB;EAC9B,MAAML,MAAM,GAAGjC,QAAQ,kDAAR,sDAA8B,EAA7C;;EACA,OAAK,IAAI6B,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,UAAKpB,MAAzB,EAAiCoB,CAAC,EAAlC,EAAsC;EACpCE,IAAAA,QAAQ,CAAMF,CAAN,4BAAMA,CAAN,yBAAMA,CAAN,GAAUI,MAAV,CAAR;EACD;;EACD,SAAOA,MAAP;EACD;;ECvBD,IAAMpB,CAAC,GAAGtB,SAAS,EAAnB;;EAGA,SAASgD,aAAT,CAAuBN,MAAvB,EAA+B;EAC7B,SACEA,MAAM,YAAYO,QAAlB,IACAP,MAAM,YAAYQ,cADlB,IAEA7C,KAAK,CAACC,OAAN,CAAcoC,MAAd,CAHF;EAKD;EAED;EACA;EACA;EACA;EACA;EACA;;;EACO,SAASS,OAAT,CAAiBT,MAAjB,EAAyBU,SAAzB,EAAoCC,IAApC,EAA0C;EAC/C,MAAIX,MAAM,YAAYY,IAAtB,EAA4B;EAC1BZ,IAAAA,MAAM,GAAG,CAACA,MAAD,CAAT;EACD;;EACD,MAAIM,aAAa,CAACN,MAAD,CAAb,IAAyB,QAAOU,SAAP,MAAqB5D,UAAlD,EAA8D;EAC5DuB,IAAAA,IAAI,CAAC2B,MAAD,EAAS,UAACa,EAAD,EAAQ;EACnB,UAAMC,WAAW,GAAG,IAAIlC,CAAC,CAACC,WAAN,CAAkB6B,SAAlB,EAA6B;EAC/C1B,QAAAA,OAAO,EAAE,IADsC;EAE/CC,QAAAA,UAAU,EAAE,IAFmC;EAG/CC,QAAAA,MAAM,EAAEyB,IAAI,IAAI;EAH+B,OAA7B,CAApB;EAKAE,MAAAA,EAAE,CAACE,aAAH,CAAiBD,WAAjB;EACD,KAPG,CAAJ;EAQD;EACF;;MCjCoBE,cACnB,qBAAYC,SAAZ,EAAuBC,YAAvB,EAAqC;EAAA;;EACnC;EACA,MAAMC,WAAW,GAAGF,SAAS,CAAC,CAAD,CAA7B;EACA,MAAMG,aAAa,GAAGH,SAAS,CAAC,CAAD,CAA/B;EACA,MAAMI,cAAc,GAAGJ,SAAS,CAAC,CAAD,CAAhC;EACA,8BAA8BI,cAAc,CAACC,MAA7C;EAAA,MAAQC,QAAR,yBAAQA,QAAR;EAAA,MAAkBC,OAAlB,yBAAkBA,OAAlB;EACA,OAAKrD,KAAL,GAAagD,WAAW,CAACM,IAAzB;EACA,OAAKC,WAAL,GAAmBP,WAAW,CAACQ,IAA/B;EACA,OAAKN,cAAL,GAAsBA,cAAtB;EACA,OAAKO,YAAL,GAAoBV,YAAY,IAAI,EAApC;EACA,OAAKE,aAAL,GAAqBA,aAAa,IAAI,EAAtC;EACA,OAAKK,IAAL,GAAY5D,IAAI,CAAC0D,QAAQ,CAACM,QAAV,CAAhB;EACA,OAAKF,IAAL,GAAYJ,QAAQ,CAACI,IAArB;EACA,OAAKG,MAAL,GAAcjE,IAAI,CAAC0D,QAAQ,CAACO,MAAT,CAAgBC,SAAhB,CAA0B,CAA1B,CAAD,CAAlB;EACA,OAAKC,UAAL,GAAkBnE,IAAI,CAAC0D,QAAQ,CAACI,IAAT,IAAiBJ,QAAQ,CAACI,IAAT,CAAcM,KAAd,CAAoBvF,GAApB,EAAyB,CAAzB,CAAlB,CAAtB;EACA,MAAQwF,KAAR,GAAkB,KAAKd,aAAvB,CAAQc,KAAR;EACA,OAAKvB,IAAL,GAAauB,KAAK,IAAIA,KAAK,CAACvB,IAAhB,IAA0Ba,OAAO,CAACU,KAAR,IAAiBV,OAAO,CAACU,KAAR,CAAcvB,IAArE;EACD;;ECjBY,SAASwB,OAAT,GAAmB;EAAA;;EAChC,SAAO,UAACC,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqB;EAChCC,QAAAA,IAAI,EAAE,cAAC3D,KAAD,EAAW;EACf,cAAMuC,cAAc,GAAGvC,KAAK,CAACI,MAAN,CAAa,CAAb,CAAvB;;EACA,cAAImC,cAAc,KAAK,KAAvB,EAA6B;EAC3BiB,YAAAA,UAAU,CAACG,IAAX,CAAgB,IAAIzB,WAAJ,CAAgBlC,KAAK,CAACI,MAAtB,EAA8BJ,KAA9B,CAAhB;EACD;EACF,SAN+B;EAOhC4D,QAAAA,KAAK,EAAEJ,UAAU,CAACI,KAPc;EAQhCC,QAAAA,QAAQ,EAAEL,UAAU,CAACK;EARW,OAArB,CAAb;EAUA,aAAO,YAAM;EACXJ,QAAAA,IAAI,CAACK,WAAL;EACD,OAFD;EAGD,KAdD,CADK;EAAA,GAAP;EAgBD;;ECbc,SAASC,gBAAT,GAA4B;EAAA;;EACzC,qBAA2C,KAAKvB,MAAhD;EAAA,MAAQwB,OAAR,gBAAQA,OAAR;EAAA,MAAiBvB,QAAjB,gBAAiBA,QAAjB;EAAA,MAA2BG,WAA3B,gBAA2BA,WAA3B;EACA,OAAKqB,oBAAL,GAA4BC,cAAS,CAAC1F,SAAS,EAAV,EAAcxB,SAAd,CAAT,CAAkC0G,SAAlC,CAC1B,UAACS,CAAD,EAAO;EACL,QAAMxB,IAAI,GAAG5D,IAAI,CACf6D,WAAW,GACPH,QAAQ,CAACI,IAAT,CAAcI,SAAd,CAAwB,CAAxB,EAA2BE,KAA3B,CAAiCvF,GAAjC,EAAsC,CAAtC,CADO,GAEP6E,QAAQ,CAACM,QAHE,CAAjB;;EAKA,QAAIJ,IAAJ,EAAU;EACRhB,MAAAA,OAAO,CAACqC,OAAD,EAAUvG,iBAAV,EAA6B,CAClC;EAAEkF,QAAAA,IAAI,EAAJA,IAAF;EAAQE,QAAAA,IAAI,EAAED;EAAd,OADkC,EAElCuB,CAFkC,EAGlC,KAHkC,CAA7B,CAAP;EAKD;EACF,GAdyB,CAA5B;EAgBA,OAAKC,SAAL,GAAiBF,cAAS,CAACF,OAAD,EAAUvG,iBAAV,CAAT,CAAsC4G,IAAtC,CACfhB,OAAO,CAACxD,KAAR,CAAc,IAAd,CADe,CAAjB;;EAGA,MAAI+C,WAAW,IAAI,CAACH,QAAQ,CAACI,IAA7B,EAAmC;EACjC,SAAKyB,GAAL,CAAS,GAAT,EAAc,IAAd,EAAoB,KAApB,EADiC;EAElC;EACF;;EC5BD;EACA;EACA;EACA;EACA;EACA;EACA;;EACA,SAASC,UAAT,CAAoBC,MAApB,EAA4BlD,GAA5B,EAAiCmD,GAAjC,EAAsC;EACpC,MAAIxF,QAAQ,CAACwF,GAAD,CAAZ,EAAmB;EACjBtD,IAAAA,MAAM,CAACC,IAAP,CAAYqD,GAAZ,EAAiBpD,OAAjB,CAAyB,UAACqD,KAAD,EAAW;EAClCH,MAAAA,UAAU,CAACC,MAAD,YAAYlD,GAAZ,cAAmB1C,KAAK,CAAC6F,GAAD,CAAL,GAAa3G,KAAb,GAAqB4G,KAAxC,QAAkDD,GAAG,CAACC,KAAD,CAArD,CAAV;EACD,KAFD;EAGD,GAJD,MAIO,IAAI,QAAOD,GAAP,MAAerG,WAAnB,EAAgC;EACrCoG,IAAAA,MAAM,CAACzD,IAAP,WAAe4D,kBAAkB,CAACrD,GAAD,CAAjC,cAA0CqD,kBAAkB,CAACF,GAAD,CAA5D;EACD;EACF;EAED;EACA;EACA;EACA;EACA;EACA;;;EACO,SAASG,aAAT,CAAuBH,GAAvB,EAA4B;EACjC,MAAID,MAAM,GAAG,EAAb;;EACA,MAAIvF,QAAQ,CAACwF,GAAD,CAAZ,EAAmB;EACjBtD,IAAAA,MAAM,CAACC,IAAP,CAAYqD,GAAZ,EAAiBpD,OAAjB,CAAyB,UAACC,GAAD,EAAS;EAChCiD,MAAAA,UAAU,CAACC,MAAD,EAASlD,GAAT,EAAcmD,GAAG,CAACnD,GAAD,CAAjB,CAAV;EACD,KAFD;EAGA,WAAOkD,MAAM,CAACK,IAAP,CAAYlH,GAAZ,CAAP;EACD;;EACD,SAAO,QAAO8G,GAAP,MAAezG,UAAf,GAA4ByG,GAA5B,GAAkC3G,KAAzC;EACD;;ECnCD;EACA;EACA;EACA;EACA;EACA;AAGA;EACA,YAAc,GAAG,SAAS,GAAG,EAAE;EAC/B,EAAE,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;EAC/B,IAAI,OAAO,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC;EAC3B,GAAG;EACH,EAAE,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,GAAG,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE;EACpD,IAAI,OAAO,MAAM,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC;EACpE,GAAG;EACH,EAAE,OAAO,KAAK,CAAC;EACf,CAAC;;ECDD;EACA;EACA;EACA;;EACA,SAASgH,SAAT,CAAmBC,CAAnB,EAAsB;EACpB,SAAO5H,WAAW,CAACmC,IAAZ,CAAiByF,CAAjB,CAAP;EACD;EAED;EACA;EACA;EACA;;;EACA,SAASC,GAAT,CAAaC,EAAb,EAAiBC,MAAjB,EAAyB;EAAA;;EACvBD,EAAAA,EAAE,GAAGlG,IAAI,CAACkG,EAAD,CAAT;;EACA,MAAIA,EAAE,CAACE,MAAH,CAAU,CAAV,MAAiBvH,GAArB,EAA0B;EACxBqH,IAAAA,EAAE,GAAGA,EAAE,CAACG,OAAH,CAAWxH,GAAX,EAAgBE,KAAhB,CAAL;EACD;;EACD,MAAMuH,WAAW,GAAGlE,MAAM,CAACmE,MAAP,CAAc,IAAd,CAApB;;EACA,MAAIL,EAAJ,EAAQ;EACNA,IAAAA,EAAE,CAAC9B,KAAH,CAASxF,GAAT,EAAc0D,OAAd,CAAsB,UAACkE,EAAD,EAAQ;EAC5B,UAAMC,IAAI,GAAGD,EAAE,CAACpC,KAAH,CAAStF,EAAT,EAAa4H,GAAb,CAAiB,UAACC,IAAD;EAAA,eAAUC,kBAAkB,CAACD,IAAD,CAA5B;EAAA,OAAjB,CAAb;EACA,OAACZ,SAAS,CAACU,IAAI,CAAC,CAAD,CAAL,CAAT,GAAqBI,OAArB,GAA+BC,MAAhC,EAAwChG,KAAxC,CACE,KADF,EAEE2F,IAAI,CAACM,MAAL,CAAY,CAACT,WAAD,EAAcH,MAAd,EAAsB,KAAtB,CAAZ,CAFF;EAID,KAND;EAOD;;EACD,SAAOG,WAAP;EACD;EAED;EACA;EACA;EACA;;;EACA,SAASU,QAAT,CAAkBlF,GAAlB,EAAuB;EACrB,MAAImF,YAAY,GAAG7E,MAAM,CAACmE,MAAP,CAAc,IAAd,CAAnB;;EACA,MAAI1G,KAAK,CAACiC,GAAD,CAAT,EAAgB;EACdA,IAAAA,GAAG,CAACQ,OAAJ,CAAY,UAACnC,KAAD,EAAQS,KAAR,EAAkB;EAC5BqG,MAAAA,YAAY,CAACrG,KAAD,CAAZ,GAAsBT,KAAtB;EACD,KAFD;EAGD;;EACD,SAAO8G,YAAP;EACD;EAED;EACA;EACA;EACA;EACA;;;EACA,SAASC,OAAT,CAAiBC,EAAjB,EAAqBC,YAArB,EAAmC;EACjC,SAAOA,YAAY,GAAI,QAAOD,EAAP,MAAchI,YAAd,GAA6B,EAA7B,GAAkCgI,EAAtC,GAA4CH,QAAQ,CAACG,EAAD,CAAvE;EACD;EAED;EACA;EACA;EACA;EACA;;;EACA,SAASE,UAAT,CAAoBF,EAApB,EAAwBG,QAAxB,EAAkC;EAChC,MAAIlH,YAAY,CAAC+G,EAAD,CAAhB,EAAsB,OAAO;EAAEA,IAAAA,EAAE,EAAFA;EAAF,GAAP;EACtB,MAAItH,KAAK,CAACsH,EAAD,CAAL,IAAa,QAAOA,EAAP,MAAchI,YAA/B,EACE,OAAO;EAAEgI,IAAAA,EAAE,EAAED,OAAO,CAACC,EAAD,EAAKI,QAAQ,CAACD,QAAD,CAAb;EAAb,GAAP;EACF,SAAO;EAAEH,IAAAA,EAAE,EAAE,CAACA,EAAD,CAAN;EAAYnF,IAAAA,IAAI,EAAEmF,EAAE,KAAK;EAAzB,GAAP;EACD;EAED;EACA;EACA;EACA;EACA;EACA;;;EACA,SAASN,OAAT,CAAiBtE,GAAjB,EAAsBpC,KAAtB,EAA6BuF,GAA7B,EAAkC8B,QAAlC,EAA4C;EAC1C,MAAMC,KAAK,GAAGlF,GAAG,CAACkF,KAAJ,CAAUpJ,YAAV,KAA2B,EAAzC;;EACA,MAAIoJ,KAAK,CAAC9G,MAAN,KAAiB,CAArB,EAAwB;EACtB,QAAM+G,IAAI,GAAGD,KAAK,CAAC,CAAD,CAAlB;EACA,QAAIH,QAAQ,GAAGG,KAAK,CAAC,CAAD,CAApB;EACAlF,IAAAA,GAAG,GAAGA,GAAG,CAAC8D,OAAJ,CAAY/H,oBAAZ,EAAkCS,KAAlC,CAAN;;EACA,QAAIgH,SAAS,CAACxD,GAAD,CAAb,EAAoB;EAClB,UAAI+E,QAAQ,KAAKvI,KAAjB,EAAwBuI,QAAQ,GAAG,GAAX;EACxB/E,MAAAA,GAAG,GAAGA,GAAG,CAAC8D,OAAJ,CAAY9H,oBAAZ,EAAkC+I,QAAlC,CAAN;EACAT,MAAAA,OAAO,CACLtE,GADK,EAELpC,KAFK,EAGJuF,GAAG,CAACgC,IAAD,CAAH,GAAYL,UAAU,CAAC3B,GAAG,CAACgC,IAAD,CAAJ,EAAYJ,QAAZ,CAAV,CAAgCH,EAHxC,EAILK,QAJK,CAAP;EAMD,KATD,MASO,IAAIF,QAAJ,EAAc;EACnB,UAAMK,QAAQ,GAAGN,UAAU,CAAC3B,GAAG,CAACgC,IAAD,CAAJ,EAAYJ,QAAZ,CAA3B;EACA5B,MAAAA,GAAG,CAACgC,IAAD,CAAH,GAAYC,QAAQ,CAACR,EAArB;EACA,UAAMS,YAAY,GAAGJ,QAAQ,GAAGrB,MAAM,CAAChG,KAAD,CAAT,GAAmBA,KAAhD;;EACA,UAAIwH,QAAQ,CAAC3F,IAAb,EAAmB;EACjB0D,QAAAA,GAAG,CAACgC,IAAD,CAAH,CAAU1F,IAAV,qBACGsF,QADH,EACcM,YADd;EAGD,OAJD,MAIO;EACLlC,QAAAA,GAAG,CAACgC,IAAD,CAAH,CAAUJ,QAAV,IAAsBM,YAAtB;EACD;EACF,KAXM,MAWA;EACLd,MAAAA,MAAM,CAACY,IAAD,EAAOvH,KAAP,EAAcuF,GAAd,EAAmB8B,QAAnB,EAA6B,IAA7B,CAAN;EACD;EACF;EACF;EAED;EACA;EACA;EACA;EACA;EACA;;;EACA,SAASV,MAAT,CAAgBvE,GAAhB,EAAqBpC,KAArB,EAA4BmG,WAA5B,EAAyCkB,QAAzC,EAAmDK,OAAnD,EAA4D;EAC1D,MAAIL,QAAJ,EAAc;EACZrH,IAAAA,KAAK,GAAGgG,MAAM,CAAChG,KAAD,CAAd;EACD;;EACD,MAAIoC,GAAG,IAAI+D,WAAX,EAAwB;EACtBA,IAAAA,WAAW,CAAC/D,GAAD,CAAX,GAAmB1C,KAAK,CAACyG,WAAW,CAAC/D,GAAD,CAAZ,CAAL,GACf+D,WAAW,CAAC/D,GAAD,CADI,GAEf,CAAC+D,WAAW,CAAC/D,GAAD,CAAZ,CAFJ;EAGA+D,IAAAA,WAAW,CAAC/D,GAAD,CAAX,CAAiBP,IAAjB,CAAsB7B,KAAtB;EACD,GALD,MAKO;EACLmG,IAAAA,WAAW,CAAC/D,GAAD,CAAX,GAAmBsF,OAAO,GAAG,CAAC1H,KAAD,CAAH,GAAaA,KAAvC;EACD;EACF;EAED;EACA;EACA;EACA;;;EACA,SAASgG,MAAT,CAAgBhG,KAAhB,EAAuB;EACrB,MAAIA,KAAK,IAAI,IAAb,EAAmB,OAAOpB,KAAP;EACnB,MAAI,QAAOoB,KAAP,MAAiBlB,UAArB,EAAiC,OAAOkB,KAAP;EACjC,MAAIoH,QAAQ,CAAEpH,KAAK,GAAGH,IAAI,CAACG,KAAD,CAAd,CAAZ,EAAqC,OAAO,CAACA,KAAR;;EACrC,UAAQA,KAAR;EACE,SAAK,MAAL;EACE,aAAO,IAAP;;EACF,SAAKhB,YAAL;EACE,aAAOH,KAAP;;EACF,SAAK,MAAL;EACE,aAAO,IAAP;;EACF,SAAK,OAAL;EACE,aAAO,KAAP;;EACF,SAAK,KAAL;EACE,aAAO8I,GAAP;;EACF;EACE,aAAO3H,KAAP;EAZJ;EAcD;;EC3JD;EACA;EACA;EACA;EACA;EACA;;EACe,SAAS4H,YAAT,CAAsBC,WAAtB,EAAmCnE,WAAnC,EAAgD;EAC7D,MAAQH,QAAR,GAAqB,KAAKD,MAA1B,CAAQC,QAAR;EACA,MAAMO,MAAM,GAAGjE,IAAI,CAAC0D,QAAQ,CAACO,MAAT,IAAmBP,QAAQ,CAACO,MAAT,CAAgBC,SAAhB,CAA0B,CAA1B,CAApB,CAAnB;EACA,MAAM+D,aAAa,GAAGpE,WAAW,GAC7B7D,IAAI,CAAC0D,QAAQ,CAACI,IAAT,CAAcM,KAAd,CAAoBvF,GAApB,EAAyB,CAAzB,CAAD,CADyB,GAE7BmB,IAAI,CAACiE,MAAD,CAFR;EAGA,MAAI,CAACgE,aAAL,EAAoB,OAAOD,WAAP;EACpB,SAAOnC,aAAa,CAClBrD,MAAM,CAAC0F,GAAO,CAACjE,MAAD,CAAR,EAAkBiE,GAAO,CAACD,aAAD,CAAzB,EAA0CC,GAAO,CAACF,WAAD,CAAjD,CADY,CAApB;EAGD;;ECNc,SAASzC,GAAT,CAAajF,KAAb,EAAoB+F,OAApB,EAA6B8B,IAA7B,EAAmC;EAChDA,EAAAA,IAAI,GAAGA,IAAI,IAAI,IAAf;EACA,qBAA+C,KAAK1E,MAApD;EAAA,MAAQ2E,YAAR,gBAAQA,YAAR;EAAA,MAAsBvE,WAAtB,gBAAsBA,WAAtB;EAAA,MAAmCF,OAAnC,gBAAmCA,OAAnC;EACA,MAAML,WAAW,GAAGd,MAAM,CACxB;EAAE6D,IAAAA,OAAO,EAAPA,OAAF;EAAW8B,IAAAA,IAAI,EAAJA;EAAX,GADwB,EAExB,QAAO7H,KAAP,MAAiBrB,UAAjB,GAA8B;EAAEqB,IAAAA,KAAK,EAALA;EAAF,GAA9B,GAA0CA,KAFlB,CAA1B;EAIA+F,EAAAA,OAAO,GAAG/C,WAAW,CAAC+C,OAAtB;EACA8B,EAAAA,IAAI,GAAG7E,WAAW,CAAC6E,IAAnB;EACA,MAAaE,QAAb,GAAuC/E,WAAvC,CAAMhD,KAAN;EAAA,MAAuB0H,WAAvB,GAAuC1E,WAAvC,CAAuB0E,WAAvB;EACA,MAAQM,aAAR,GAAkDhF,WAAlD,CAAQgF,aAAR;EAAA,MAAuBxF,IAAvB,GAAkDQ,WAAlD,CAAuBR,IAAvB;EAAA,8BAAkDQ,WAAlD,CAA6BiF,SAA7B;EAAA,MAA6BA,SAA7B,sCAAyC,IAAzC;EACA,MAAMC,UAAU,GAAGH,QAAQ,CAACjE,KAAT,CAAevF,GAAf,CAAnB,CAXgD;;EAahD,MAAIqB,QAAQ,CAAC8H,WAAD,CAAZ,EAA2B;EACzBA,IAAAA,WAAW,GAAGnC,aAAa,CAACmC,WAAD,CAA3B;EACD,GAf+C;;;EAiBhDA,EAAAA,WAAW,GAAGhI,IAAI,CAACgI,WAAW,GAAGA,WAAH,GAAiBQ,UAAU,CAAC,CAAD,CAAvC,CAAlB;EACAH,EAAAA,QAAQ,GAAGrI,IAAI,CAACwI,UAAU,CAAC,CAAD,CAAX,CAAf,CAlBgD;;EAoBhD,MAAIF,aAAJ,EAAmB;EACjBN,IAAAA,WAAW,GAAGD,YAAY,CAACjH,KAAb,CAAmB,IAAnB,EAAyB,CAACkH,WAAD,EAAcnE,WAAd,CAAzB,CAAd;EACD;;EACD,MAAIxD,YAAY,CAACgI,QAAD,CAAhB,EAA4B;EAC1B,QAAMI,eAAe,GAAGJ,QAAxB;;EACA,QAAIxE,WAAJ,EAAiB;EACfwE,MAAAA,QAAQ,eAAQA,QAAR,CAAR,CADe;;EAGf,UAAID,YAAJ,EAAkB;EAChBC,QAAAA,QAAQ,aAAMA,QAAQ,CAACnE,SAAT,CAAmB,CAAnB,CAAN,CAAR;EACD;EACF,KARyB;;;EAU1BmE,IAAAA,QAAQ,aAAMA,QAAN,SAAiBL,WAAW,aAAMnJ,GAAG,GAAGmJ,WAAZ,IAA4BjJ,KAAxD,CAAR;EACA4E,IAAAA,OAAO,CAAC0C,OAAO,GAAG7G,OAAH,GAAaD,IAArB,CAAP,CAAkC;EAAEuD,MAAAA,IAAI,EAAJA;EAAF,KAAlC,EAA4CyF,SAA5C,EAAuDF,QAAvD;;EACA,QAAIF,IAAI,IAAIM,eAAZ,EAA6B;EAC3B7F,MAAAA,OAAO,CAAC,KAAKa,MAAL,CAAYwB,OAAb,EAAsBvG,iBAAtB,EAAyC,CAC9C;EACEkF,QAAAA,IAAI,EAAE6E,eADR;EAEE3E,QAAAA,IAAI,EAAED;EAFR,OAD8C,EAK9C7E,KAL8C,EAM9C,IAN8C,CAAzC,CAAP;EAQD;EACF,GAtBD,MAsBO;EACL,UAAM,IAAI0J,SAAJ,CAAcjK,aAAd,CAAN;EACD;;EACD,SAAO,IAAP;EACD;;EC5Dc,SAASkK,QAAT,CAAkBC,MAAlB,EAA0B;EAAA;;EACvC,qBAAwC,KAAKnF,MAA7C;EAAA,MAAqBK,IAArB,gBAAQD,WAAR;EAAA,MAA2BH,QAA3B,gBAA2BA,QAA3B;EACA,MAAME,IAAI,GAAG5D,IAAI,CACf8D,IAAI,GAAGJ,QAAQ,CAACI,IAAT,CAAcI,SAAd,CAAwB,CAAxB,EAA2BE,KAA3B,CAAiCvF,GAAjC,EAAsC,CAAtC,CAAH,GAA8C6E,QAAQ,CAACM,QAD5C,CAAjB;EAGA,SAAO,UAACO,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqBF,UAArB,CAAb;;EACA,UAAI,CAACmE,MAAL,EAAa;EACXA,QAAAA,MAAM,GAAG,IAAT;;EACA,YAAIhF,IAAJ,EAAU;EACRa,UAAAA,UAAU,CAACG,IAAX,CAAgB,IAAIzB,WAAJ,CAAgB,CAAC;EAAES,YAAAA,IAAI,EAAJA,IAAF;EAAQE,YAAAA,IAAI,EAAJA;EAAR,WAAD,EAAiB9E,KAAjB,EAAwB,KAAxB,CAAhB,CAAhB;EACD;EACF;;EACD,aAAO,YAAM;EACX0F,QAAAA,IAAI,CAACK,WAAL;EACD,OAFD;EAGD,KAXD,CADK;EAAA,GAAP;EAaD;;MChBoB8D;EACnB,oBAAyB;EAAA,QAAbpF,MAAa,uEAAJ,EAAI;;EAAA;;EACvB,qBAAwChE,SAAS,EAAjD;EAAA,QAAQkE,OAAR,cAAQA,OAAR;EAAA,QAAiBD,QAAjB,cAAiBA,QAAjB;EAAA,QAA2BnC,QAA3B,cAA2BA,QAA3B;;EACA,QAAI,CAACoC,OAAO,CAACpE,IAAD,CAAZ,EAAoB;EAClB,YAAM,IAAIuJ,KAAJ,CAAUtK,mBAAV,CAAN;EACD;;EACDiF,IAAAA,MAAM,GAAGjB,MAAM,CACb;EACEqB,MAAAA,WAAW,EAAE,KADf;EACsB;EACpBuE,MAAAA,YAAY,EAAE,KAFhB;EAEuB;EACrBnD,MAAAA,OAAO,EAAE1D,QAAQ,CAACwH,IAHpB;EAG0B;EACxBrF,MAAAA,QAAQ,EAARA,QAJF;EAIY;EACVC,MAAAA,OAAO,EAAPA,OALF;;EAAA,KADa,EAQbF,MARa,CAAf;EAUA,SAAKA,MAAL,GAAcrB,MAAM,CAAC4G,MAAP,CAAcvF,MAAd,CAAd;EACA,SAAKwF,SAAL,GAAiB,EAAjB;EACAjE,IAAAA,gBAAgB,CAAClE,KAAjB,CAAuB,IAAvB;EACD;;;;aACD,gBAAa;EAAA;;EAAA,wCAALoI,GAAK;EAALA,QAAAA,GAAK;EAAA;;EACX,aAAO,wBAAK7D,SAAL,EAAeC,IAAf,yBAAoBqD,QAAQ,CAAC7H,KAAT,CAAe,IAAf,CAApB,SAA6CoI,GAA7C,EAAP;EACD;;;aACD,qBAAkB;EAAA;;EAChB,aAAO,6BAAK7D,SAAL,CAAeC,IAAf,CAAoBqD,QAAQ,CAAC7H,KAAT,CAAe,IAAf,CAApB,GAA0C6D,SAA1C,uCAAP;EACD;;;aACD,iBAAc;EAAA,yCAAPwE,KAAO;EAAPA,QAAAA,KAAO;EAAA;;EACZ,aAAO5D,GAAG,CAACzE,KAAJ,CAAU,IAAV,EAAgBqI,KAAhB,CAAP;EACD;;;aACD,iBAAQzI,QAAR,EAAkB;EAChB,UAAI,QAAOA,QAAP,MAAoBrB,WAAxB,EAAqC;EACnCqB,QAAAA,QAAQ;EACT;;EACD,WAAKwE,oBAAL,CAA0BH,WAA1B,GAJgB;;EAKhB,WAAKkE,SAAL,CAAetI,MAAf,GAAwB,CAAxB;EACD;;;;;;ECxCH;EACA;EACA;EACA;EACA;EACA;EACA;;EACO,SAASyI,aAAT,CAAuBC,IAAvB,EAA6BzF,IAA7B,EAAmC;EACxC,MAAM1C,MAAM,GAAG,EAAf;;EACA,MAAIhD,gBAAgB,CAACqC,IAAjB,CAAsB8I,IAAtB,CAAJ,EAAiC;EAC/B,QAAMC,SAAS,GAAG,IAAIC,MAAJ,CAChBF,IAAI,CAAChD,OAAL,CAAa,KAAb,EAAoB,KAApB,EAA2BA,OAA3B,CAAmC,WAAnC,EAAgD,WAAhD,CADgB,CAAlB;EAGAnI,IAAAA,gBAAgB,CAACsL,SAAjB,GAA6B,CAA7B;;EACA,QAAIF,SAAS,CAAC/I,IAAV,CAAeqD,IAAf,CAAJ,EAA0B;EACxB,UAAMvB,IAAI,GAAGvC,KAAK,CAAC8B,IAAN,CAAWyH,IAAI,CAAC5B,KAAL,CAAWvJ,gBAAX,CAAX,EAAyCwI,GAAzC,CAA6C,UAACnE,GAAD;EAAA,eACxDA,GAAG,CAAC8D,OAAJ,CAAY,GAAZ,EAAiBtH,KAAjB,CADwD;EAAA,OAA7C,CAAb;EAGA,UAAM0K,MAAM,GAAG3J,KAAK,CAAC8B,IAAN,CAAWgC,IAAI,CAAC6D,KAAL,CAAW6B,SAAX,CAAX,CAAf;EACAG,MAAAA,MAAM,CAACC,KAAP;EACArH,MAAAA,IAAI,CAACC,OAAL,CAAa,UAACC,GAAD,EAAM3B,KAAN,EAAgB;EAC3BM,QAAAA,MAAM,CAACqB,GAAD,CAAN,GAAckH,MAAM,CAAC7I,KAAD,CAApB;EACD,OAFD;EAGD;EACF;;EACD,SAAOM,MAAP;EACD;;ECfD;EACA;EACA;EACA;EACA;EACA;;EACO,SAASZ,KAAT,CAAe+H,QAAf,EAAyB7E,cAAzB,EAAyCmG,UAAzC,EAAqD;EAC1D,MAAI,QAAOnG,cAAP,MAA0BtE,WAA9B,EAA2C;EACzCyK,IAAAA,UAAU,GAAGnG,cAAb;EACAA,IAAAA,cAAc,GAAGxE,KAAjB;EACD;;EACDqJ,EAAAA,QAAQ,GAAGrI,IAAI,CAACqI,QAAD,CAAf;;EACA,MAAI7E,cAAc,YAAYqF,MAA9B,EAAsC;EACpC,QAAMe,KAAK,GAAGpG,cAAc,CAACyF,SAA7B;;EACA,QAAIW,KAAK,CAACC,OAAN,CAAcxB,QAAd,MAA4B,CAAC,CAAjC,EAAoC;EAClCuB,MAAAA,KAAK,CAAC5H,IAAN,CAAWqG,QAAX;EACD;EACF;;EACD,SAAO,UAAC9D,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqB;EAChCC,QAAAA,IADgC,gBAC3B3D,KAD2B,EACpB;EACV,cAAI6I,aAAa,GAAG7I,KAAK,CAACX,KAA1B;;EACA,cAAID,YAAY,CAACgI,QAAD,CAAhB,EAA4B;EAC1B,gBAAIsB,UAAJ,EAAgB;EACdtB,cAAAA,QAAQ,GAAGA,QAAQ,CAAC0B,WAAT,EAAX;EACAD,cAAAA,aAAa,GAAGA,aAAa,CAACC,WAAd,EAAhB;EACD;;EACD,gBAAM7I,MAAM,GAAGkI,aAAa,CAACf,QAAD,EAAWyB,aAAX,CAA5B;EACA,gBAAME,YAAY,GAAG5H,MAAM,CAACC,IAAP,CAAYnB,MAAZ,EAAoBP,MAAzC;;EACA,gBAAImJ,aAAa,KAAKzB,QAAlB,IAA8B2B,YAAY,GAAG,CAAjD,EAAoD;EAClD,kBAAIA,YAAY,GAAG,CAAnB,EAAsB;EACpB/I,gBAAAA,KAAK,CAACC,MAAN,GAAeA,MAAf;EACD;;EACDuD,cAAAA,UAAU,CAACG,IAAX,CAAgB3D,KAAhB;EACD;EACF,WAbD,MAaO;EACLwD,YAAAA,UAAU,CAACI,KAAX,CAAiB,IAAIiE,KAAJ,CAAUrK,aAAV,CAAjB;EACD;EACF,SAnB+B;EAoBhCoG,QAAAA,KAAK,EAAEJ,UAAU,CAACI,KApBc;EAqBhCC,QAAAA,QAAQ,EAAEL,UAAU,CAACK;EArBW,OAArB,CAAb;EAuBA,aAAO,YAAM;EACX,YAAItB,cAAc,YAAYqF,MAA9B,EAAsC;EACpC,cAAMe,MAAK,GAAGpG,cAAc,CAACyF,SAA7B;;EACA,cAAMgB,kBAAkB,GAAGL,MAAK,CAACC,OAAN,CAAcxB,QAAd,CAA3B;;EACA,cAAI4B,kBAAkB,GAAG,CAAC,CAA1B,EAA6B;EAC3BL,YAAAA,MAAK,CAACM,MAAN,CAAaD,kBAAb,EAAiC,CAAjC;EACD;EACF;;EACDvF,QAAAA,IAAI,CAACK,WAAL;EACD,OATD;EAUD,KAlCD,CADK;EAAA,GAAP;EAoCD;EAED;EACA;EACA;EACA;;EACO,SAASmD,OAAT,CAAiB/B,MAAjB,EAAyB;EAC9B,SAAO,UAAC5B,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqB;EAChCC,QAAAA,IADgC,gBAC3B3D,KAD2B,EACpB;EACV,cAAI;EACFA,YAAAA,KAAK,CAACgD,MAAN,GAAekG,GAAY,CAAClJ,KAAK,CAACgD,MAAP,EAAekC,MAAf,CAA3B;EACAlF,YAAAA,KAAK,CAACkD,UAAN,GAAmBgG,GAAY,CAAClJ,KAAK,CAACkD,UAAP,EAAmBgC,MAAnB,CAA/B;EACA1B,YAAAA,UAAU,CAACG,IAAX,CAAgB3D,KAAhB;EACD,WAJD,CAIE,OAAOmE,CAAP,EAAU;EACVX,YAAAA,UAAU,CAACI,KAAX,CAAiBO,CAAjB;EACD;EACF,SAT+B;EAUhCP,QAAAA,KAAK,EAAEJ,UAAU,CAACI,KAVc;EAWhCC,QAAAA,QAAQ,EAAEL,UAAU,CAACK;EAXW,OAArB,CAAb;EAaA,aAAO,YAAM;EACXJ,QAAAA,IAAI,CAACK,WAAL;EACD,OAFD;EAGD,KAjBD,CADK;EAAA,GAAP;EAmBD;EAED;EACA;EACA;EACA;;EACO,SAASqF,OAAT,CAAiB5G,cAAjB,EAAiC;EACtC,SAAO,UAACe,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqB;EAChCC,QAAAA,IADgC,gBAC3B3D,KAD2B,EACpB;EACV,cAAIuC,cAAc,YAAYqF,MAA9B,EAAsC;EACpC,gBAAMe,KAAK,GAAGpG,cAAc,CAACyF,SAA7B;;EACA,gBAAIW,KAAK,CAACjJ,MAAN,GAAe,CAAnB,EAAsB;EACpB,kBAAM0J,YAAY,GAAGpJ,KAAK,CAACX,KAA3B;EACA,kBAAImH,KAAK,GAAG,KAAZ;;EACA,mBAAK,IAAI1F,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG6H,KAAK,CAACjJ,MAA1B,EAAkCoB,CAAC,EAAnC,EAAuC;EACrC,oBACE6H,KAAK,CAAC7H,CAAD,CAAL,KAAasI,YAAb,IACAjI,MAAM,CAACC,IAAP,CAAY+G,aAAa,CAACQ,KAAK,CAAC7H,CAAD,CAAN,EAAWsI,YAAX,CAAzB,EAAmD1J,MAFrD,EAGE;EACA8G,kBAAAA,KAAK,GAAG,IAAR;EACA;EACD;EACF;;EACD,kBAAI,CAACA,KAAL,EAAY;EACVxG,gBAAAA,KAAK,CAACmJ,OAAN,GAAgB,IAAhB;EACA3F,gBAAAA,UAAU,CAACG,IAAX,CAAgB3D,KAAhB;EACD;EACF;EACF;EACF,SAtB+B;EAuBhC4D,QAAAA,KAAK,EAAEJ,UAAU,CAACI,KAvBc;EAwBhCC,QAAAA,QAAQ,EAAEL,UAAU,CAACK;EAxBW,OAArB,CAAb;EA0BA,aAAO,YAAM;EACXJ,QAAAA,IAAI,CAACK,WAAL;EACD,OAFD;EAGD,KA9BD,CADK;EAAA,GAAP;EAgCD;;EAED,SAASuF,cAAT,CAAwBC,KAAxB,EAA+BC,MAA/B,EAAuCC,MAAvC,EAA+C;EAC7CjK,EAAAA,IAAI,CAAC4B,MAAM,CAACC,IAAP,CAAYkI,KAAZ,CAAD,EAAqB,UAAChI,GAAD,EAAS;EAChC,QAAIrC,QAAQ,CAACqK,KAAK,CAAChI,GAAD,CAAN,CAAR,IAAwBrC,QAAQ,CAACsK,MAAM,CAACjI,GAAD,CAAP,CAApC,EAAmD;EACjD+H,MAAAA,cAAc,CAACC,KAAK,CAAChI,GAAD,CAAN,EAAaiI,MAAM,CAACjI,GAAD,CAAnB,EAA0BkI,MAA1B,CAAd;EACD,KAFD,MAEO;EACLA,MAAAA,MAAM,SAAN,GAAeF,KAAK,CAAChI,GAAD,CAAL,KAAeiI,MAAM,CAACjI,GAAD,CAApC;EACD;EACF,GANG,CAAJ;EAOD;EAED;EACA;EACA;EACA;EACA;;;EACO,SAASmI,KAAT,GAA2C;EAAA,MAA5BrI,IAA4B,uEAArB1D,aAAqB;EAAA,MAANgM,IAAM;EAChD,MAAID,KAAK,GAAG,EAAZ;;EACA,MAAI,QAAOrI,IAAP,MAAgBnD,WAApB,EAAiC;EAC/ByL,IAAAA,IAAI,GAAGtI,IAAP;EACAA,IAAAA,IAAI,GAAG1D,aAAP;EACD;;EACD,SAAO,UAAC4F,UAAD;EAAA,WACL,IAAIC,eAAJ,CAAe,UAACC,UAAD,EAAgB;EAC7B,UAAMC,IAAI,GAAGH,UAAU,CAACI,SAAX,CAAqB;EAChCC,QAAAA,IADgC,gBAC3B3D,KAD2B,EACpB;EACVT,UAAAA,IAAI,CAAC6B,IAAD,EAAO,UAACE,GAAD,EAAS;EAClB,gBAAIoI,IAAI,IAAIzK,QAAQ,CAACe,KAAK,CAACsB,GAAD,CAAN,CAAhB,IAAgCrC,QAAQ,CAACwK,KAAK,CAACnI,GAAD,CAAN,CAA5C,EAA0D;EACxD,kBAAMkI,MAAM,GAAG,EAAf;EACAH,cAAAA,cAAc,CAACrJ,KAAK,CAACsB,GAAD,CAAN,EAAamI,KAAK,CAACnI,GAAD,CAAlB,EAAyBkI,MAAzB,CAAd;;EACA,kBAAIA,MAAM,SAAV,EAAkB;EAChBjI,gBAAAA,MAAM,CAACkI,KAAD,EAAQzJ,KAAR,CAAN;EACAwD,gBAAAA,UAAU,CAACG,IAAX,CAAgB3D,KAAhB;EACA,uBAAO,KAAP;EACD;EACF,aARD,MAQO,IAAIA,KAAK,CAACsB,GAAD,CAAL,KAAemI,KAAK,CAACnI,GAAD,CAAxB,EAA+B;EACpCC,cAAAA,MAAM,CAACkI,KAAD,EAAQzJ,KAAR,CAAN;EACAwD,cAAAA,UAAU,CAACG,IAAX,CAAgB3D,KAAhB;EACA,qBAAO,KAAP,CAHoC;EAIrC;EACF,WAdG,CAAJ;EAeD,SAjB+B;EAkBhC4D,QAAAA,KAAK,EAAEJ,UAAU,CAACI,KAlBc;EAmBhCC,QAAAA,QAAQ,EAAEL,UAAU,CAACK;EAnBW,OAArB,CAAb;EAqBA,aAAO,YAAM;EACXJ,QAAAA,IAAI,CAACK,WAAL;EACA2F,QAAAA,KAAK,GAAG,EAAR;EACD,OAHD;EAID,KA1BD,CADK;EAAA,GAAP;EA4BD;;;;;;;;;;;;;;;;;;;"}
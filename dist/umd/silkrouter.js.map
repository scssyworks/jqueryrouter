{"version":3,"file":"silkrouter.js","sources":["../../src/js/utils/constants.js","../../src/js/utils/utils.js","../../src/js/utils/assign.js","../../src/js/utils/triggerEvent.js","../../src/js/utils/vars.js","../../src/js/store/compression/compress.js","../../src/js/store/compression/decompress.js","../../src/js/store/compression/utf16.js","../../src/js/store/storage/index.js","../../src/js/store/index.js","../../src/js/utils/libs.js","../../src/js/api/routerEvent/index.js","../../src/js/api/collate/index.js","../../src/js/api/bindRouterEvents/index.js","../../src/js/utils/query.js","../../node_modules/is-number/index.js","../../src/js/utils/deparam.js","../../src/js/api/resolveQuery/index.js","../../src/js/api/set/index.js","../../src/js/api/callOnce/index.js","../../src/js/api/router/index.js","../../src/js/utils/params.js","../../src/js/operators/index.js"],"sourcesContent":["/**\n * Router constants\n */\nexport const HASH_CHANGE = 'hashchange';\nexport const POP_STATE = 'popstate';\nexport const REG_ROUTE_PARAMS = /:[^/]+/g;\nexport const REG_PATHNAME = /^\\/(?=[^?]*)/;\nexport const REG_COMPLEX = /\\[/;\nexport const REG_VARIABLE = /([^[]+)\\[([^[]*)\\]/;\nexport const REG_REPLACE_BRACKETS = /\\[([^[]*)\\]/;\nexport const REG_REPLACE_NEXTPROP = /[^[]+/;\nexport const HISTORY_UNSUPPORTED = 'Current browser does not support history object';\nexport const INVALID_ROUTE = 'Route string is not a pure route';\nexport const LOCAL_ENV = ['localhost', '0.0.0.0', '127.0.0.1', null];\nexport const VIRTUAL_PUSHSTATE = 'vpushstate';\nexport const CACHED_FIELDS = [\n    'route',\n    'hashRouting',\n    'path',\n    'hash',\n    'search',\n    'hashSearch',\n    'data'\n];\n","import { REG_PATHNAME } from './constants';\n\n/**\n * Shorthand for Array.isArray\n */\nexport const isArr = Array.isArray;\n\n/**\n * Safely trims string\n * @param {string} str String\n */\nexport function trim(str) {\n  return typeof str === 'string' ? str.trim() : '';\n}\n\n/**\n * Checks if value is an object\n * @param {*} value Any type of value\n */\nexport function isObject(value) {\n  return value && typeof value === 'object';\n}\n\n/**\n * Checks if key is a true object\n * @param {*} value Any type of value\n */\nexport function isPureObject(value) {\n  return isObject(value) && !isArr(value);\n}\n\n/**\n * Checks if given route is valid\n * @private\n * @param {string} route Route string\n */\nexport function isValidRoute(route) {\n  return typeof route === 'string' && REG_PATHNAME.test(route);\n}\n\n/**\n * Checks if key is present in provided object\n * @param {object} ob Object\n * @param {*} key Key\n */\nexport function hasOwn(ob, key) {\n  return Object.prototype.hasOwnProperty.call(ob, key);\n}\n\n/**\n * Loops over an array like object\n * @param {object} arrayObj Array or array like object\n * @param {function} callback Callback function\n */\nexport function each(arrayObj, callback) {\n  if (arrayObj && arrayObj.length) {\n    for (let index = 0; index < arrayObj.length; index += 1) {\n      if (typeof callback === 'function') {\n        const continueTheLoop = callback.apply(arrayObj, [\n          arrayObj[index],\n          index,\n        ]);\n        if (typeof continueTheLoop === 'boolean') {\n          if (continueTheLoop) {\n            continue;\n          } else {\n            break;\n          }\n        }\n      }\n    }\n  }\n}\n","import { isObject } from './utils';\n\n/**\n * Inner loop function for assign\n * @private\n * @param {object} ref Argument object\n * @param {object} target First object\n */\nfunction loopFunc(ref, target) {\n    if (isObject(ref)) {\n        Object.keys(ref).forEach(function (key) {\n            target[key] = ref[key];\n        });\n    }\n}\n\n/**\n * Polyfill for Object.assign only smaller and with less features\n * @private\n * @returns {object}\n */\nexport function assign() {\n    const target = isObject(arguments[0]) ? arguments[0] : {};\n    for (let i = 1; i < arguments.length; i++) {\n        loopFunc(arguments[i], target);\n    }\n    return target;\n}","import { each } from './utils';\n\n// Polyfill custom event\nif (typeof window.CustomEvent === 'undefined') {\n    const CustomEvent = function (event, params) {\n        params = params || { bubbles: false, cancelable: false, detail: undefined };\n        const evt = document.createEvent('CustomEvent');\n        evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n        return evt;\n    }\n\n    CustomEvent.prototype = window.Event.prototype;\n    window.CustomEvent = CustomEvent;\n}\n\n// Internal function\nfunction isValidTarget(target) {\n    return (\n        target instanceof NodeList\n        || target instanceof HTMLCollection\n        || Array.isArray(target)\n    );\n}\n\n/**\n * Function to trigger custom event\n * @param {Node|NodeList|HTMLCollection|Node[]} target Target element or list\n * @param {string} eventType Event type\n * @param {any[]} data Data to be passed to handler\n */\nexport function trigger(target, eventType, data) {\n    if (target instanceof Node) {\n        target = [target];\n    }\n    if (isValidTarget(target) && typeof eventType === 'string') {\n        each(target, el => {\n            const customEvent = new window.CustomEvent(eventType, {\n                bubbles: true,\n                cancelable: true,\n                detail: (data || [])\n            });\n            el.dispatchEvent(customEvent);\n        });\n    }\n}","export const loc = window.location;\nexport const f = String.fromCharCode;\n","import { hasOwn } from '../../utils/utils';\n\nfunction _update(context, bitsPerChar, getCharFromInt) {\n    if (context.context_data_position == bitsPerChar - 1) {\n        context.context_data_position = 0;\n        context.context_data.push(getCharFromInt(context.context_data_val));\n        context.context_data_val = 0;\n    } else {\n        context.context_data_position++;\n    }\n}\n\nfunction _updateContextNumBits(context) {\n    context.context_enlargeIn--;\n    if (context.context_enlargeIn == 0) {\n        context.context_enlargeIn = 2 ** context.context_numBits;\n        context.context_numBits++;\n    }\n}\n\nfunction _updateContext(context, bitsPerChar, getCharFromInt) {\n    if (hasOwn(context.context_dictionaryToCreate, context.context_w)) {\n        if (context.context_w.charCodeAt(0) < 256) {\n            for (let i = 0; i < context.context_numBits; i++) {\n                context.context_data_val = (context.context_data_val << 1);\n                _update(context, bitsPerChar, getCharFromInt);\n            }\n            context.value = context.context_w.charCodeAt(0);\n            for (let i = 0; i < 8; i++) {\n                context.context_data_val = (context.context_data_val << 1) | (context.value & 1);\n                _update(context, bitsPerChar, getCharFromInt);\n                context.value = context.value >> 1;\n            }\n        } else {\n            context.value = 1;\n            for (let i = 0; i < context.context_numBits; i++) {\n                context.context_data_val = (context.context_data_val << 1) | context.value;\n                _update(context, bitsPerChar, getCharFromInt);\n                context.value = 0;\n            }\n            context.value = context.context_w.charCodeAt(0);\n            for (let i = 0; i < 16; i++) {\n                context.context_data_val = (context.context_data_val << 1) | (context.value & 1);\n                _update(context, bitsPerChar, getCharFromInt);\n                context.value = context.value >> 1;\n            }\n        }\n        _updateContextNumBits(context);\n        delete context.context_dictionaryToCreate[context.context_w];\n    } else {\n        context.value = context.context_dictionary[context.context_w];\n        for (let i = 0; i < context.context_numBits; i++) {\n            context.context_data_val = (context.context_data_val << 1) | (context.value & 1);\n            _update(context, bitsPerChar, getCharFromInt);\n            context.value = context.value >> 1;\n        }\n    }\n    _updateContextNumBits(context);\n}\n\nfunction compress(uncompressed, bitsPerChar, getCharFromInt) {\n    if (uncompressed == null) return '';\n    const context = {\n        context_dictionary: {},\n        context_dictionaryToCreate: {},\n        context_data: [],\n        context_c: \"\",\n        context_wc: \"\",\n        context_w: \"\",\n        context_enlargeIn: 2,\n        context_dictSize: 3,\n        context_numBits: 2,\n        context_data_val: 0,\n        context_data_position: 0\n    };\n    let i = 0;\n    for (let ii = 0; ii < uncompressed.length; ii += 1) {\n        context.context_c = uncompressed.charAt(ii);\n        if (!hasOwn(context.context_dictionary, context.context_c)) {\n            context.context_dictionary[context.context_c] = context.context_dictSize++;\n            context.context_dictionaryToCreate[context.context_c] = true;\n        }\n        context.context_wc = context.context_w + context.context_c;\n        if (hasOwn(context.context_dictionary, context.context_wc)) {\n            context.context_w = context.context_wc;\n        } else {\n            _updateContext(context, bitsPerChar, getCharFromInt);\n            context.context_dictionary[context.context_wc] = context.context_dictSize++;\n            context.context_w = String(context.context_c);\n        }\n    }\n    if (context.context_w !== \"\") {\n        _updateContext(context, bitsPerChar, getCharFromInt);\n    }\n    context.value = 2;\n    for (i = 0; i < context.context_numBits; i++) {\n        context.context_data_val = (context.context_data_val << 1) | (context.value & 1);\n        _update(context, bitsPerChar, getCharFromInt);\n        context.value = context.value >> 1;\n    }\n    // Flush the last char\n    // eslint-disable-next-line\n    while (true) {\n        context.context_data_val = (context.context_data_val << 1);\n        if (context.context_data_position == bitsPerChar - 1) {\n            context.context_data.push(getCharFromInt(context.context_data_val));\n            break;\n        }\n        else context.context_data_position++;\n    }\n    return context.context_data.join('');\n}\n\nexport default compress;","import { f } from '../../utils/vars';\n\nfunction _commonRep3(data, maxpower, resetValue, getNextValue) {\n    let bits = 0;\n    let power = 1;\n    while (power !== maxpower) {\n        const resb = data.val & data.position;\n        data.position >>= 1;\n        if (data.position === 0) {\n            data.position = resetValue;\n            data.val = getNextValue(data.index++);\n        }\n        bits |= (resb > 0 ? 1 : 0) * power;\n        power <<= 1;\n    }\n    return bits;\n}\n\nfunction decompress(length, resetValue, getNextValue) {\n    const dictionary = [];\n    const data = {\n        val: getNextValue(0),\n        position: resetValue,\n        index: 1\n    };\n    const result = [];\n    let enlargeIn = 4;\n    let dictSize = 4;\n    let numBits = 3;\n    let entry = '';\n    let w;\n    let c;\n    for (let i = 0; i < 3; i++) {\n        dictionary[i] = i;\n    }\n    switch (_commonRep3(data, Math.pow(2, 2), resetValue, getNextValue)) {\n        case 0:\n            c = f(_commonRep3(data, Math.pow(2, 8), resetValue, getNextValue));\n            break;\n        case 1:\n            c = f(_commonRep3(data, Math.pow(2, 16), resetValue, getNextValue));\n            break;\n        case 2:\n            return '';\n    }\n    dictionary[3] = c;\n    w = c;\n    result.push(c);\n    // eslint-disable-next-line\n    while (true) {\n        if (data.index > length) {\n            return '';\n        }\n        switch (c = _commonRep3(data, Math.pow(2, numBits), resetValue, getNextValue)) {\n            case 0:\n                dictionary[dictSize++] = f(_commonRep3(data, Math.pow(2, 8), resetValue, getNextValue));\n                c = dictSize - 1;\n                enlargeIn--;\n                break;\n            case 1:\n                dictionary[dictSize++] = f(_commonRep3(data, Math.pow(2, 16), resetValue, getNextValue));\n                c = dictSize - 1;\n                enlargeIn--;\n                break;\n            case 2:\n                return result.join('');\n        }\n        if (enlargeIn === 0) {\n            enlargeIn = Math.pow(2, numBits);\n            numBits++;\n        }\n        if (dictionary[c]) {\n            entry = dictionary[c];\n        } else {\n            if (c === dictSize) {\n                entry = w + w.charAt(0);\n            } else {\n                return null;\n            }\n        }\n        result.push(entry);\n        dictionary[dictSize++] = w + entry.charAt(0);\n        enlargeIn--;\n        w = entry;\n        if (enlargeIn === 0) {\n            enlargeIn = Math.pow(2, numBits);\n            numBits++;\n        }\n    }\n}\n\nexport default decompress;","import compress from './compress';\nimport decompress from './decompress';\nimport { f } from '../../utils/vars';\n\nexport function toUTF16(input) {\n    if (input == null) return '';\n    return compress(input, 15, (a) => f(a + 32)) + ' ';\n}\n\nexport function fromUTF16(compressed) {\n    if (compressed == null) return '';\n    if (compressed === '') return null;\n    return decompress(compressed.length, 16384, (index) => (compressed.charCodeAt(index) - 32));\n}","import { trim, each, isObject } from '../../utils/utils';\nimport { loc } from '../../utils/vars';\nimport { LOCAL_ENV } from '../../utils/constants';\nimport { toUTF16, fromUTF16 } from '../compression/utf16';\n\n/**\n * Sets user cookie\n * @param {string} key name of cookie\n * @param {string} value cookie value\n * @param {string} exp cookie expiry\n * @param {string} path url path\n * @param {string} domain supported domain\n * @param {boolean} isSecure Sets security flag\n */\nfunction setCookie(key, value) {\n    if (key && typeof value !== 'undefined') {\n        const domain = loc.hostname;\n        const isSecure = loc.protocol === 'https:';\n        let transformedValue = value;\n        if (isObject(value)) {\n            transformedValue = JSON.stringify(value);\n        }\n        const cookiePath = `; path=/`;\n        const cookieDomain = (LOCAL_ENV.indexOf(domain) === -1) ? `; domain=${trim(domain)}` : '';\n        const secureFlag = isSecure ? '; secure' : '';\n        document.cookie = `${key} = ${transformedValue}${cookieDomain}${cookiePath}${secureFlag}`;\n    }\n}\n\n/**\n * Get's cookie value\n * @param {string} key Key\n * @param {boolean} trimResult Flag to trim the value\n */\nfunction getCookie(key) {\n    if (key) {\n        const cookieStr = decodeURIComponent(document.cookie);\n        let value = '';\n        each(cookieStr.split(';'), cookiePair => {\n            const keyPart = `${key}=`;\n            const indexOfKey = cookiePair.indexOf(keyPart);\n            if (indexOfKey > -1) {\n                value = trim(cookiePair.substring((indexOfKey + keyPart.length), cookiePair.length));\n                return false;\n            }\n        });\n        return value;\n    }\n    return '';\n}\n\n/**\n * Returns true if local storage is accessible\n */\nfunction isStorageAvailable() {\n    try {\n        sessionStorage.setItem('testKey', 'testValue');\n        sessionStorage.removeItem('testKey');\n        return true;\n    } catch (e) {\n        return false;\n    }\n}\n\nexport function set(key, value) {\n    if (isStorageAvailable()) {\n        return sessionStorage.setItem(key, toUTF16(isObject(value) ? JSON.stringify(value) : value));\n    }\n    return setCookie(key, value);\n}\n\nexport function get(key) {\n    if (isStorageAvailable()) {\n        let value = fromUTF16(sessionStorage.getItem(key));\n        try {\n            value = JSON.parse(value);\n            return value;\n        } catch (e) {\n            return value;\n        }\n    }\n    return getCookie(key);\n}","import { get, set } from './storage';\n\nexport const store = {\n    set() {\n        return set.apply(this, arguments);\n    },\n    get() {\n        return get.apply(this, arguments);\n    }\n};","import { assign } from './assign';\nimport { isPureObject } from './utils';\nimport { store } from '../store';\n\nclass StorageLib {\n    getDataFromStore(path) {\n        const paths = assign(store.get('routeStore'));\n        return paths[path];\n    }\n    setDataToStore(path, data) {\n        let paths = assign(store.get('routeStore'));\n        if (paths[path]) {\n            if (!data\n                || (isPureObject(data) && Object.keys(data).length === 0)\n            ) return false;\n        }\n        return store.set('routeStore', assign({}, paths, {\n            [path]: data\n        }));\n    }\n}\n\nexport const libs = new StorageLib();","import { trim } from '../../utils/utils';\nimport { libs } from '../../utils/libs';\n\nexport default class RouterEvent {\n    constructor(routeInfo, currentEvent) {\n        // Set relevant parameters\n        const [routeObject, originalEvent, routerInstance] = routeInfo;\n        const { location, preservePath } = routerInstance.config;\n        this.route = routeObject.path;\n        this.hashRouting = routeObject.hash;\n        this.routerInstance = routerInstance;\n        this.virtualEvent = currentEvent || {};\n        this.originalEvent = originalEvent || {};\n        this.path = trim(location.pathname);\n        this.hash = location.hash;\n        this.search = trim(location.search.substring(1));\n        this.hashSearch = trim(location.hash && location.hash.split('?')[1]);\n        // Extract data\n        let { path } = routeObject;\n        if (this.hashRouting) {\n            path = `/#${path}`;\n            if (preservePath) {\n                path = `${location.pathname}${path.substring(1)}`;\n            }\n        }\n        // Set route data to store\n        libs.setDataToStore(path, this.originalEvent.state && this.originalEvent.state.data);\n        // Get current data from store\n        this.data = libs.getDataFromStore(path);\n    }\n}","import { Observable } from 'rxjs';\nimport RouterEvent from '../routerEvent';\n\nexport default function collate() {\n    const currentRouterInstance = this;\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next(event) {\n                const [, , routerInstance] = event.detail;\n                if (routerInstance === currentRouterInstance) {\n                    subscriber.next(\n                        new RouterEvent(event.detail, event)\n                    );\n                }\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        return () => {\n            subn.unsubscribe();\n        }\n    });\n}","import { fromEvent } from 'rxjs';\nimport { POP_STATE, VIRTUAL_PUSHSTATE } from '../../utils/constants';\nimport { trigger } from '../../utils/triggerEvent';\nimport collate from '../collate';\nimport { trim } from '../../utils/utils';\n\nexport default function bindRouterEvents() {\n    const { context, location, hashRouting } = this.config;\n    this.popStateSubscription = fromEvent(window, POP_STATE).subscribe(e => {\n        const path = trim(\n            hashRouting\n                ? location.hash.substring(1).split('?')[0]\n                : location.pathname\n        );\n        if (path) {\n            trigger(context, VIRTUAL_PUSHSTATE, [{ path, hash: hashRouting }, e, this]);\n        }\n    });\n    this.listeners = fromEvent(context, VIRTUAL_PUSHSTATE)\n        .pipe(collate.apply(this));\n    if (hashRouting && !location.hash) {\n        this.set('/', true, false); // Replace current hash path without executing anythings\n    }\n}","import { isArr, isObject } from './utils';\n\n/**\n * Builds query string recursively\n * @private\n * @param {string[]} qsList List of query string key value pairs\n * @param {*} key Key\n * @param {*} obj Value\n */\nfunction buildQuery(qsList, key, obj) {\n    if (isObject(obj)) {\n        Object.keys(obj).forEach(obKey => {\n            buildQuery(qsList, `${key}[${isArr(obj) ? '' : obKey}]`, obj[obKey]);\n        });\n    } else if (typeof obj !== 'function') {\n        qsList.push(`${encodeURIComponent(key)}=${encodeURIComponent(obj)}`);\n    }\n}\n\n/**\n * Converts an object to a query string\n * @private\n * @param {object} obj Object which should be converted to a string\n * @returns {string}\n */\nexport function toQueryString(obj) {\n    let qsList = [];\n    if (isObject(obj)) {\n        Object.keys(obj).forEach(key => {\n            buildQuery(qsList, key, obj[key]);\n        });\n        return qsList.join('&');\n    }\n    return typeof obj === 'string' ? obj : '';\n}","/*!\n * is-number <https://github.com/jonschlinkert/is-number>\n *\n * Copyright (c) 2014-present, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function(num) {\n  if (typeof num === 'number') {\n    return num - num === 0;\n  }\n  if (typeof num === 'string' && num.trim() !== '') {\n    return Number.isFinite ? Number.isFinite(+num) : isFinite(+num);\n  }\n  return false;\n};\n","import isNumber from 'is-number';\nimport { loc } from './vars';\nimport { isArr, trim, isPureObject } from './utils';\nimport {\n  REG_COMPLEX,\n  REG_VARIABLE,\n  REG_REPLACE_BRACKETS,\n  REG_REPLACE_NEXTPROP,\n} from './constants';\n\n/**\n * Checks if query parameter key is a complex notation\n * @param {string} q\n */\nfunction ifComplex(q) {\n  return REG_COMPLEX.test(q);\n}\n\n/**\n * Converts query string to JavaScript object\n * @param {string} qs query string argument (defaults to url query string)\n */\nfunction deparam(qs = loc.search, coerce = false) {\n  qs = trim(qs);\n  if (qs.charAt(0) === '?') {\n    qs = qs.replace('?', '');\n  }\n  const queryObject = Object.create(null);\n  if (qs) {\n    qs.split('&').forEach((qq) => {\n      const qArr = qq.split('=').map((part) => decodeURIComponent(part));\n      (ifComplex(qArr[0]) ? complex : simple).apply(this, [\n        ...qArr,\n        queryObject,\n        coerce,\n        false,\n      ]);\n    });\n  }\n  return queryObject;\n}\n\n/**\n * Converts an array to an object\n * @param {array} arr\n */\nfunction toObject(arr) {\n  var convertedObj = Object.create(null);\n  if (isArr(arr)) {\n    arr.forEach((value, index) => {\n      convertedObj[index] = value;\n    });\n  }\n  return convertedObj;\n}\n\n/**\n * Resolves an array to object if required\n * @param {array} ob An array object\n * @param {boolean} isNumber flag to test if next key is number\n */\nfunction resolve(ob, isNextNumber) {\n  return isNextNumber ? (typeof ob === 'undefined' ? [] : ob) : toObject(ob);\n}\n\n/**\n * Resolves the target object for next iteration\n * @param {Object} ob current reference object\n * @param {string} nextProp reference property in current object\n */\nfunction resolveObj(ob, nextProp) {\n  if (isPureObject(ob)) return { ob };\n  if (isArr(ob) || typeof ob === 'undefined')\n    return { ob: resolve(ob, isNumber(nextProp)) };\n  return { ob: [ob], push: ob !== null };\n}\n\n/**\n * Handles complex query parameters\n * @param {string} key\n * @param {string} value\n * @param {Object} obj\n */\nfunction complex(key, value, obj, coercion) {\n  const match = key.match(REG_VARIABLE) || [];\n  if (match.length === 3) {\n    const prop = match[1];\n    let nextProp = match[2];\n    key = key.replace(REG_REPLACE_BRACKETS, '');\n    if (ifComplex(key)) {\n      if (nextProp === '') nextProp = '0';\n      key = key.replace(REG_REPLACE_NEXTPROP, nextProp);\n      complex(\n        key,\n        value,\n        (obj[prop] = resolveObj(obj[prop], nextProp).ob),\n        coercion\n      );\n    } else if (nextProp) {\n      const resolved = resolveObj(obj[prop], nextProp);\n      obj[prop] = resolved.ob;\n      const coercedValue = coercion ? coerce(value) : value;\n      if (resolved.push) {\n        obj[prop].push({\n          [nextProp]: coercedValue,\n        });\n      } else {\n        obj[prop][nextProp] = coercedValue;\n      }\n    } else {\n      simple(prop, value, obj, coercion, true);\n    }\n  }\n}\n\n/**\n * Handles simple query\n * @param {array} qArr\n * @param {Object} queryObject\n * @param {boolean} toArray\n */\nfunction simple(key, value, queryObject, coercion, toArray) {\n  if (coercion) {\n    value = coerce(value);\n  }\n  if (key in queryObject) {\n    queryObject[key] = isArr(queryObject[key])\n      ? queryObject[key]\n      : [queryObject[key]];\n    queryObject[key].push(value);\n  } else {\n    queryObject[key] = toArray ? [value] : value;\n  }\n}\n\n/**\n * Restores values to their original type\n * @param {string} value undefined or string value\n */\nfunction coerce(value) {\n  if (value == null) return '';\n  if (typeof value !== 'string') return value;\n  if (isNumber((value = trim(value)))) return +value;\n  switch (value) {\n    case 'null':\n      return null;\n    case 'undefined':\n      return undefined;\n    case 'true':\n      return true;\n    case 'false':\n      return false;\n    case 'NaN':\n      return NaN;\n    default:\n      return value;\n  }\n}\n\n// Library encapsulation\nfunction lib() {\n  return deparam.apply(this, arguments);\n}\n\nexport { lib as deparam };\n","import { trim } from '../../utils/utils';\nimport { toQueryString } from '../../utils/query';\nimport { assign } from '../../utils/assign';\nimport { deparam } from '../../utils/deparam';\n\n/**\n * Resolves and analyzes existing query string\n * @private\n * @param {string} queryString Query string\n * @param {string} hashRouting Flag to test if hash routing is enabled\n */\nexport default function resolveQuery(queryString, hashRouting) {\n    const { location } = this.config;\n    const search = trim(location.search && location.search.substring(1));\n    const existingQuery = hashRouting\n        ? trim(location.hash.split('?')[1])\n        : trim(search);\n    if (!existingQuery) return queryString;\n    return toQueryString(assign(deparam(search), deparam(existingQuery), deparam(queryString)));\n}","import { trigger } from '../../utils/triggerEvent';\nimport { VIRTUAL_PUSHSTATE, INVALID_ROUTE } from '../../utils/constants';\nimport { isValidRoute, trim, isObject } from '../../utils/utils';\nimport { libs } from '../../utils/libs';\nimport { toQueryString } from '../../utils/query';\nimport resolveQuery from '../resolveQuery';\nimport { assign } from '../../utils/assign';\n\nexport default function set(\n    route,\n    replace = false,\n    exec = true\n) {\n    const { preservePath, hashRouting, location, history } = this.config;\n    const routeObject = assign(\n        { replace, exec },\n        (typeof route === 'string') ? { route } : route\n    )\n    replace = routeObject.replace;\n    exec = routeObject.exec;\n    let {\n        route: routeStr,\n        queryString\n    } = routeObject;\n    const {\n        preserveQuery,\n        data,\n        pageTitle = document.querySelector('head title').textContent\n    } = routeObject;\n    const routeParts = routeStr.split('?');\n    // Check if query string is an object\n    if (isObject(queryString)) {\n        queryString = toQueryString(queryString);\n    }\n    // Resolve to URL query string if it's not explicitly passed\n    queryString = trim(queryString ? queryString : routeParts[1]);\n    routeStr = trim(routeParts[0]);\n    // Check if query preservation is required. Resolve query accordingly\n    if (preserveQuery) {\n        queryString = resolveQuery.apply(this, [queryString, hashRouting]);\n    }\n    if (isValidRoute(routeStr)) {\n        const unmodifiedRoute = routeStr;\n        if (hashRouting) {\n            routeStr = `/#${routeStr}`;\n            // Path preservation should only work for hash routing\n            if (preservePath) {\n                routeStr = `${routeStr.substring(1)}`;\n            }\n        }\n        // Sync data to store before appending query string. Query string should have no effect on stored data\n        libs.setDataToStore(\n            preservePath\n                ? `${location.pathname}${routeStr}`\n                : routeStr,\n            data\n        );\n        // Append query string\n        routeStr = `${routeStr}${queryString ? `?${queryString}` : ''}`;\n        history[replace ? 'replaceState' : 'pushState']({ data }, pageTitle, routeStr);\n        if (exec && unmodifiedRoute) {\n            trigger(this.config.context, VIRTUAL_PUSHSTATE, [{\n                path: unmodifiedRoute,\n                hash: hashRouting\n            }, undefined, this]);\n        }\n    } else {\n        throw new TypeError(INVALID_ROUTE);\n    }\n    return this;\n}","import { Observable } from 'rxjs';\nimport { trim } from '../../utils/utils';\nimport RouterEvent from '../routerEvent';\n\nexport default function callOnce(isDone) {\n    const { hashRouting, location } = this.config;\n    const path = trim(hashRouting ? location.hash.substring(1).split('?')[0] : location.pathname);\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next() {\n                subscriber.next(...arguments);\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        if (!isDone) {\n            isDone = true;\n            if (path) {\n                subscriber.next(\n                    new RouterEvent([{ path, hash: hashRouting }, undefined, this])\n                );\n            }\n        }\n        return () => {\n            subn.unsubscribe();\n        }\n    });\n}","import { assign } from '../../utils/assign';\nimport bindRouterEvents from '../bindRouterEvents';\nimport set from '../set';\nimport { HISTORY_UNSUPPORTED } from '../../utils/constants';\nimport callOnce from '../callOnce';\n\nexport default class Router {\n    constructor(config = {}) {\n        if (!window.history.pushState) {\n            throw new Error(HISTORY_UNSUPPORTED);\n        }\n        config = assign({\n            hashRouting: false, // Switch to hash routing\n            preservePath: false, // Works for hash routing\n            context: document.body, // To change the context of \"vpushstate\" event\n            location: window.location, // Should remain unchanged\n            history: window.history // History object\n        }, config);\n        this.config = Object.freeze(config);\n        this.__paths__ = [];\n        bindRouterEvents.apply(this);\n    }\n    pipe() {\n        return this.listeners.pipe(\n            callOnce.apply(this),\n            ...arguments\n        );\n    }\n    subscribe() {\n        return this.listeners\n            .pipe(callOnce.apply(this))\n            .subscribe(...arguments);\n    }\n    set() {\n        return set.apply(this, arguments);\n    }\n    destroy(callback) {\n        if (typeof callback === 'function') {\n            callback();\n        }\n        this.popStateSubscription.unsubscribe(); // Unsubscribe popstate event\n        this.__paths__.length = 0;\n    }\n}","import { REG_ROUTE_PARAMS } from './constants';\nimport { loc } from './vars';\n\n/**\n * Parses current path and returns params object\n * @private\n * @param {string} expr Route expression\n * @param {string} path URL path\n * @returns {object}\n */\nexport function extractParams(expr, path = loc.pathname) {\n    const params = {};\n    if (REG_ROUTE_PARAMS.test(expr)) {\n        const pathRegex = new RegExp(expr.replace(/\\//g, \"\\\\/\").replace(/:[^/\\\\]+/g, \"([^\\\\/]+)\"));\n        REG_ROUTE_PARAMS.lastIndex = 0;\n        if (pathRegex.test(path)) {\n            const keys = [...expr.match(REG_ROUTE_PARAMS)].map(key => key.replace(':', ''));\n            const values = [...path.match(pathRegex)];\n            values.shift();\n            keys.forEach((key, index) => {\n                params[key] = values[index];\n            });\n        }\n    }\n    return params;\n}","import { trim, isValidRoute, each, isObject } from '../utils/utils';\nimport { Observable } from 'rxjs';\nimport { INVALID_ROUTE, CACHED_FIELDS } from '../utils/constants';\nimport { extractParams } from '../utils/params';\nimport { deparam as queryDeparam } from '../utils/deparam';\nimport Router from '../api/router';\nimport { assign } from '../utils/assign';\n\n/**\n * Operator to compare a specific route\n * @param {string} routeStr Route string\n * @param {Router} routerInstance Current router object [optional]\n * @param {boolean} ignoreCase Ignore case in route string\n */\nexport function route(routeStr, routerInstance, ignoreCase) {\n    if (typeof routerInstance === 'boolean') {\n        ignoreCase = routerInstance;\n        routerInstance = undefined;\n    }\n    routeStr = trim(routeStr);\n    if (routerInstance instanceof Router) {\n        const paths = routerInstance.__paths__;\n        if (paths.indexOf(routeStr) === -1) {\n            paths.push(routeStr);\n        }\n    }\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next(event) {\n                let incomingRoute = event.route;\n                if (isValidRoute(routeStr)) {\n                    if (ignoreCase) {\n                        routeStr = routeStr.toLowerCase();\n                        incomingRoute = incomingRoute.toLowerCase();\n                    }\n                    const params = extractParams(routeStr, incomingRoute);\n                    const paramsLength = Object.keys(params).length;\n                    if (\n                        incomingRoute === routeStr\n                        || paramsLength > 0\n                    ) {\n                        if (paramsLength > 0) {\n                            event.params = params;\n                        }\n                        subscriber.next(event);\n                    }\n                } else {\n                    subscriber.error(\n                        new Error(INVALID_ROUTE)\n                    );\n                }\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        return () => {\n            if (routerInstance instanceof Router) {\n                const paths = routerInstance.__paths__;\n                const existingRouteIndex = paths.indexOf(routeStr);\n                if (existingRouteIndex > -1) {\n                    paths.splice(existingRouteIndex, 1);\n                }\n            }\n            subn.unsubscribe();\n        }\n    });\n}\n\n/**\n * Converts search and hashSearch strings to object\n * @param {boolean} coerce Flag to enable value typecast\n */\nexport function deparam(coerce = false) {\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next(event) {\n                try {\n                    event.search = queryDeparam(event.search, coerce);\n                    event.hashSearch = queryDeparam(event.hashSearch, coerce);\n                    subscriber.next(event);\n                } catch (e) {\n                    subscriber.error(e);\n                }\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        return () => {\n            subn.unsubscribe();\n        }\n    });\n}\n\n/**\n * Modifies current subscriber to detect errors\n * @param {Router} routerInstance Current router object\n */\nexport function noMatch(routerInstance) {\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next(event) {\n                if (routerInstance instanceof Router) {\n                    const paths = routerInstance.__paths__;\n                    if (paths.length > 0) {\n                        const currentRoute = event.route;\n                        let match = false;\n                        for (let i = 0; i < paths.length; i++) {\n                            if (paths[i] === currentRoute || Object.keys(extractParams(paths[i], currentRoute)).length) {\n                                match = true;\n                                break;\n                            }\n                        }\n                        if (!match) {\n                            event.noMatch = true;\n                            subscriber.next(event);\n                        }\n                    }\n                }\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        return () => {\n            subn.unsubscribe();\n        }\n    });\n}\n\nfunction deepComparison(first, second, result) {\n    each(Object.keys(first), key => {\n        if (\n            isObject(first[key])\n            && isObject(second[key])\n        ) {\n            deepComparison(first[key], second[key], result);\n        } else {\n            result.break = first[key] !== second[key];\n        }\n    });\n}\n\n/**\n * Caches incoming routes to avoid calling handler if there is no change\n * @param {string[]} keys\n * @param {boolean} deep\n */\nexport function cache(keys = CACHED_FIELDS, deep = false) {\n    let cache = {};\n    if (typeof keys === 'boolean') {\n        deep = keys;\n        keys = CACHED_FIELDS;\n    }\n    return (observable) => new Observable(subscriber => {\n        const subn = observable.subscribe({\n            next(event) {\n                each(keys, key => {\n                    if (\n                        deep\n                        && isObject(event[key])\n                        && isObject(cache[key])\n                    ) {\n                        const result = {};\n                        deepComparison(event[key], cache[key], result);\n                        if (result.break) {\n                            assign(cache, event);\n                            subscriber.next(event);\n                            return false;\n                        }\n                    } else if (event[key] !== cache[key]) {\n                        assign(cache, event);\n                        subscriber.next(event);\n                        return false; // break loop\n                    }\n                });\n            },\n            error() {\n                subscriber.error(...arguments);\n            },\n            complete() {\n                subscriber.complete();\n            }\n        });\n        return () => {\n            subn.unsubscribe();\n            cache = {};\n        };\n    });\n}"],"names":["POP_STATE","REG_ROUTE_PARAMS","REG_PATHNAME","REG_COMPLEX","REG_VARIABLE","REG_REPLACE_BRACKETS","REG_REPLACE_NEXTPROP","HISTORY_UNSUPPORTED","INVALID_ROUTE","LOCAL_ENV","VIRTUAL_PUSHSTATE","CACHED_FIELDS","isArr","Array","isArray","trim","str","isObject","value","isPureObject","isValidRoute","route","test","hasOwn","ob","key","Object","prototype","hasOwnProperty","call","each","arrayObj","callback","length","index","continueTheLoop","apply","loopFunc","ref","target","keys","forEach","assign","arguments","i","window","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","isValidTarget","NodeList","HTMLCollection","trigger","eventType","data","Node","el","customEvent","dispatchEvent","loc","location","f","String","fromCharCode","_update","context","bitsPerChar","getCharFromInt","context_data_position","context_data","push","context_data_val","_updateContextNumBits","context_enlargeIn","context_numBits","_updateContext","context_dictionaryToCreate","context_w","charCodeAt","context_dictionary","compress","uncompressed","context_c","context_wc","context_dictSize","ii","charAt","join","_commonRep3","maxpower","resetValue","getNextValue","bits","power","resb","val","position","decompress","dictionary","result","enlargeIn","dictSize","numBits","entry","w","c","Math","pow","toUTF16","input","a","fromUTF16","compressed","setCookie","domain","hostname","isSecure","protocol","transformedValue","JSON","stringify","cookiePath","cookieDomain","indexOf","secureFlag","cookie","getCookie","cookieStr","decodeURIComponent","split","cookiePair","keyPart","indexOfKey","substring","isStorageAvailable","sessionStorage","setItem","removeItem","e","set","get","getItem","parse","store","StorageLib","path","paths","libs","RouterEvent","routeInfo","currentEvent","routeObject","originalEvent","routerInstance","config","preservePath","hashRouting","hash","virtualEvent","pathname","search","hashSearch","setDataToStore","state","getDataFromStore","collate","currentRouterInstance","observable","Observable","subscriber","subn","subscribe","next","error","complete","unsubscribe","bindRouterEvents","popStateSubscription","fromEvent","listeners","pipe","buildQuery","qsList","obj","obKey","encodeURIComponent","toQueryString","ifComplex","q","deparam","qs","coerce","replace","queryObject","create","qq","qArr","map","part","complex","simple","toObject","arr","convertedObj","resolve","isNextNumber","resolveObj","nextProp","isNumber","coercion","match","prop","resolved","coercedValue","toArray","NaN","lib","resolveQuery","queryString","existingQuery","exec","history","routeStr","preserveQuery","pageTitle","querySelector","textContent","routeParts","unmodifiedRoute","TypeError","callOnce","isDone","Router","pushState","Error","body","freeze","__paths__","extractParams","expr","pathRegex","RegExp","lastIndex","values","shift","ignoreCase","incomingRoute","toLowerCase","paramsLength","existingRouteIndex","splice","queryDeparam","noMatch","currentRoute","deepComparison","first","second","cache","deep"],"mappings":"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"}
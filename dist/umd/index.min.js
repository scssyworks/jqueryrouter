/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.4.3
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("argon-storage")):"function"==typeof define&&define.amd?define(["exports","argon-storage"],n):n((t=t||self).silkrouter={},t.ArgonStorage)}(this,(function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var e="hashchange",r="popstate",a="route.changed",o=/:[^\/]+/g,c=/^\/(?=[^?]*)/,i=/\?.+/,u="Route string is not a pure route",s="$$";function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=Array.isArray;function l(t){return"string"==typeof t?t.trim():""}function p(t){return t=l("".concat(t)),!(["null","undefined",""].indexOf(t)>-1)&&!isNaN(Number(t))}function d(t){return t&&"object"===f(t)&&!h(t)}function g(t,n){return void 0===t?n:t}function v(t){return Array.prototype.slice.call(t)}function y(t){return"string"==typeof t&&c.test(t)}function m(t){return"string"==typeof t&&"#"===t.charAt(0)}function b(t){return"function"==typeof t}function S(t,n){return{type:t,state:{data:n}}}var E=window.location;function w(t,n){n=g(n,E.pathname);var e={};if(o.test(t)){var r=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(o.lastIndex=0,r.test(n)){var a=v(t.match(o)).map((function(t){return t.replace(":","")})),c=v(n.match(r));c.shift(),a.forEach((function(t,n){e[t]=c[n]}))}}return e}function O(t){var n=[];return d(t)||h(t)?(Object.keys(t).forEach((function(e){!function t(n,e,r){var a=!1;d(r)||(a=h(r))?Object.keys(r).forEach((function(o){var c=a?"":o;t(n,"".concat(e,"[").concat(c,"]"),r[o])})):["string","number","boolean","undefined","object"].indexOf(f(r))>-1&&n.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(r)))}(n,e,t[e])})),n.join("&")):"string"==typeof t?t:""}function j(t){return/\[/.test(t)}function C(t,n){var e=this;t=l(g(t,E.search)),n=g(n,!1),"?"===t.charAt(0)&&(t=t.replace("?",""));var r=t.split("&"),a={};return t&&r.forEach((function(t){var r=t.split("=").map((function(t){return decodeURIComponent(t)}));j(r[0])?x.apply(e,[].concat(r).concat([a,n])):D.apply(e,[r,a,!1,n])})),a}function I(t,n){return void 0===t&&(t=[]),n?t:(r={},h(e=t)&&e.forEach((function(t,n){r[n]=t})),r);var e,r}function N(t,n){return d(t)?{ob:t}:h(t)||void 0===t?{ob:I(t,p(n))}:{ob:[t],push:null!==t}}function x(t,n,e,r){r=g(r,!0);var a=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===a.length){var o=a[1],c=a[2];if(j(t=t.replace(/\[([^\[]*)\]/,"")))""===c&&(c="0"),x(t=t.replace(/[^\[]+/,c),n,e[o]=N(e[o],c).ob,r);else if(c){var i=N(e[o],c);e[o]=i.ob;var u=r?k(n):n;if(i.push){var s={};s[c]=u,e[o].push(s)}else e[o][c]=u}else D([a[1],n],e,!0)}}function D(t,n,e,r){r=g(r,!0);var a=t[0],o=t[1];r&&(o=k(o)),a in n?(n[a]=h(n[a])?n[a]:[n[a]],n[a].push(o)):n[a]=e?[o]:o}function k(t){if(null==t)return"";if("string"!=typeof t)return t;if(p(t=l(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function A(){return C.apply(this,arguments)}function M(t,n){d(t)&&Object.keys(t).forEach((function(e){n[e]=t[e]}))}function L(){for(var t=d(arguments[0])?arguments[0]:{},n=1;n<arguments.length;n++)M(arguments[n],t);return t}var R=new n({compress:!0}),T={getDataFromStore:function(t,n){return L(R.get("routeStore"))["".concat(n?"#":"").concat(t)]},setDataToStore:function(t,n,e){var r=L(R.get("routeStore"));if(r[t]&&(!e||d(e)&&0===Object.keys(e).length))return!1;var a={};return a["".concat(n?"#":"").concat(t)]=e,r=L({},r,a),R.set("routeStore",r,!0)},handlers:[],contains:function(t){return!!this.handlers.filter(t).length}};function q(){var t=A(),n={},e=E.hash.match(i);return e&&(n=L({},A(e[0]))),L({},t,n)}function H(t,n,e){e=L(e);var r=m(n),a=(n=n.substring(r?1:0)).split("?")[0];Object.keys(e).length&&T.setDataToStore(a,r,e);var o=T.getDataFromStore(a,r),c=w(t,n);return{hasMatch:Object.keys(c).length>0||y(n)&&(t===n||"*"===t),data:o,params:c}}function P(t){t.type=t.hash?e:r;var n=g(t.originalData,{});t.originalEvent=g(t.originalEvent,S(t.type,n)),delete t.originalData,function(t,n,e){e=L(e),T.handlers.forEach((function(r){if(r.eventName===t){var a=r.route,o=n.hash?E.hash:E.pathname;r.isCaseInsensitive&&(a=a.toLowerCase(),o=o.toLowerCase());var c=H(a,o,e),i=c.hasMatch,u=c.data,s=c.params;i&&(!r.hash||r.hash&&n.hash)&&r.handler(L({},n,{data:u,params:s,query:q()}))}}))}(a,t,n)}function U(t,n,e){var r=L({replaceMode:n,noTrigger:e},"string"==typeof t?{route:t}:t);if("string"==typeof r.route){var a=m(r.route),o=l(r.route).split("?"),c=o[0].substring(a?1:0),i=l(o[1]);if(i=O(i||l(r.queryString)),!y(c))throw new Error(u);T.setDataToStore(c,a,r.data);var s=function(t,n,e,r){return e=l(e.substring("?"===e.charAt(0)?1:0)),n?"".concat(E.pathname).concat(E.search,"#").concat(t).concat(e?"?".concat(e):""):r?"".concat(t).concat(E.search).concat(e?"&".concat(e):""):"".concat(t).concat(e?"?".concat(e):"")}(c,a,i,r.appendQuery);history[r.replaceMode?"replaceState":"pushState"]({data:r.data},r.title,s),r.noTrigger||P({route:"".concat(a?"#":"").concat(c),hash:a})}}function F(t,n,o){var c="string"==typeof t&&0===t.indexOf(s);if(b(t)&&(o=n,n=t,t="*"),h(t))!function(t,n){var e=this;T.contains((function(t){return t.prevHandler===n}))||F((function(r){b(n)&&t.indexOf("".concat(r.hash?"#":"").concat(r.route.substring(r.hash?1:0)))>-1&&n.apply(e,[r])}),n)}(t,n);else{var i=m(t=t.substring(c?s.length:0));t=t.substring(i?1:0),!T.contains((function(e){return e.handler===n&&e.route===t}))&&b(n)&&T.handlers.push({eventName:a,handler:n,prevHandler:o,route:t,hash:i,caseIgnored:c,isCaseInsensitive:c}),(i?[E.hash]:[E.pathname,E.hash]).filter((function(t){return l(t)})).forEach((function(a){var o=c?t.toLowerCase():t,i=c?a.toLowerCase():a,u=m(a),s=H(o,i);if(s.hasMatch&&b(n)){var f=u?e:r;n({originalEvent:S(f,s.data),route:a,hash:u,eventName:f,data:s.data,params:s.params,query:q(),caseIgnored:c,isCaseInsensitive:c})}}))}}function $(t,n){var e=T.handlers.length,r=h(t),a=v(arguments);return 0===a.length?(T.handlers.length=0,e):(r&&(t="*"),T.handlers=T.handlers.filter((function(e){return 1!==a.length||"string"!=typeof t||r?(1===a.length&&b(t)&&(n=t,t="*"),!(e.route===t&&(e.handler===n||e.prevHandler===n))):e.route!==t})),e-T.handlers.length)}var _={set:function(){return U.apply(this,arguments)}};function Q(){return F.apply(this,arguments)}window.addEventListener("".concat(r),(function(t){var n="".concat(E.pathname).concat(E.hash).split("#"),e={originalEvent:t,originalData:L(t.state&&t.state.data)};P(L({},e,{route:n[0],hash:!1})),n[1]&&P(L({},e,{route:"#".concat(n[1]),hash:!0}))})),t.deparam=A,t.param=O,t.route=Q,t.routeIgnoreCase=function(t){"string"==typeof t&&Q.apply(this,["".concat(s).concat(t),v(arguments).slice(1)])},t.routeParams=w,t.router=_,t.unroute=function(){return $.apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0})}));

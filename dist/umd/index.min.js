/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.5.5
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n((t=t||self).silkrouter={})}(this,(function(t){"use strict";var n=/:[^\/]+/g,e=/^\/(?=[^?]*)/,a=/\?.+/,o=["localhost","0.0.0.0","127.0.0.1",null];function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=Array.isArray;function i(t){return"string"==typeof t?t.trim():""}function u(t){return t=i("".concat(t)),!(["null","undefined",""].indexOf(t)>-1)&&!isNaN(+t)}function s(t){return t&&"object"===r(t)}function f(t){return s(t)&&!c(t)}function l(t,n){return void 0===t?n:t}function h(t){return Array.prototype.slice.call(t)}function p(t){return"string"==typeof t&&e.test(t)}function d(t){return"string"==typeof t&&"#"===t.charAt(0)}function v(t){return"function"==typeof t}function _(t,n){return{type:t,state:{data:n}}}function x(t){return t?Object.keys(t):[]}function y(t,n){return Object.prototype.hasOwnProperty.call(t,n)}var g=window.location,m=String.fromCharCode;function w(t,e){e=l(e,g.pathname);var a={};if(n.test(t)){var o=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(n.lastIndex=0,o.test(e)){var r=h(t.match(n)).map((function(t){return t.replace(":","")})),c=h(e.match(o));c.shift(),r.forEach((function(t,n){a[t]=c[n]}))}}return a}function b(t){var n=[];return s(t)?(x(t).forEach((function(e){!function t(n,e,a){s(a)?x(a).forEach((function(o){t(n,"".concat(e,"[").concat(c(a)?"":o,"]"),a[o])})):"function"!=typeof a&&n.push("".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(a)))}(n,e,t[e])})),n.join("&")):"string"==typeof t?t:""}function S(t){return/\[/.test(t)}function C(t,n){var e=this;"?"===(t=i(l(t,g.search))).charAt(0)&&(t=t.replace("?",""));var a={};return t&&t.split("&").forEach((function(t){var o=t.split("=").map((function(t){return decodeURIComponent(t)}));(S(o[0])?O:A).apply(e,[].concat(o,[a,l(n,!1),!1]))})),a}function E(t,n){return n?void 0===t?[]:t:(a={},c(e=t)&&e.forEach((function(t,n){a[n]=t})),a);var e,a}function I(t,n){return f(t)?{ob:t}:c(t)||void 0===t?{ob:E(t,u(n))}:{ob:[t],push:null!==t}}function O(t,n,e,a){a=l(a,!0);var o=t.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===o.length){var r=o[1],c=o[2];if(S(t=t.replace(/\[([^\[]*)\]/,"")))""===c&&(c="0"),O(t=t.replace(/[^\[]+/,c),n,e[r]=I(e[r],c).ob,a);else if(c){var i=I(e[r],c);e[r]=i.ob;var u=a?M(n):n;if(i.push){var s={};s[c]=u,e[r].push(s)}else e[r][c]=u}else A(r,n,e,a,!0)}}function A(t,n,e,a,o){l(a,!0)&&(n=M(n)),t in e?(e[t]=c(e[t])?e[t]:[e[t]],e[t].push(n)):e[t]=o?[n]:n}function M(t){if(null==t)return"";if("string"!=typeof t)return t;if(u(t=i(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function k(){return C.apply(this,arguments)}function N(t,n){s(t)&&x(t).forEach((function(e){n[e]=t[e]}))}function T(){for(var t=s(arguments[0])?arguments[0]:{},n=1;n<arguments.length;n++)N(arguments[n],t);return t}function j(t,n,e){t.context_data_position==n-1?(t.context_data_position=0,t.context_data.push(e(t.context_data_val)),t.context_data_val=0):t.context_data_position++}function D(t){t.context_enlargeIn--,0==t.context_enlargeIn&&(t.context_enlargeIn=Math.pow(2,t.context_numBits),t.context_numBits++)}function B(t,n,e){if(y(t.context_dictionaryToCreate,t.context_w)){if(t.context_w.charCodeAt(0)<256){for(var a=0;a<t.context_numBits;a++)t.context_data_val=t.context_data_val<<1,j(t,n,e);t.value=t.context_w.charCodeAt(0);for(var o=0;o<8;o++)t.context_data_val=t.context_data_val<<1|1&t.value,j(t,n,e),t.value=t.value>>1}else{t.value=1;for(var r=0;r<t.context_numBits;r++)t.context_data_val=t.context_data_val<<1|t.value,j(t,n,e),t.value=0;t.value=t.context_w.charCodeAt(0);for(var c=0;c<16;c++)t.context_data_val=t.context_data_val<<1|1&t.value,j(t,n,e),t.value=t.value>>1}D(t),delete t.context_dictionaryToCreate[t.context_w]}else{t.value=t.context_dictionary[t.context_w];for(var i=0;i<t.context_numBits;i++)t.context_data_val=t.context_data_val<<1|1&t.value,j(t,n,e),t.value=t.value>>1}D(t)}function R(t,n,e,a){for(var o=0,r=1;r!==n;){var c=t.val&t.position;t.position>>=1,0===t.position&&(t.position=e,t.val=a(t.index++)),o|=(c>0?1:0)*r,r<<=1}return o}function $(t){return null==t?"":function(t,n,e){if(null==t)return"";for(var a={context_dictionary:{},context_dictionaryToCreate:{},context_data:[],context_c:"",context_wc:"",context_w:"",context_enlargeIn:2,context_dictSize:3,context_numBits:2,context_data_val:0,context_data_position:0},o=0,r=0;r<t.length;r+=1)a.context_c=t.charAt(r),y(a.context_dictionary,a.context_c)||(a.context_dictionary[a.context_c]=a.context_dictSize++,a.context_dictionaryToCreate[a.context_c]=!0),a.context_wc=a.context_w+a.context_c,y(a.context_dictionary,a.context_wc)?a.context_w=a.context_wc:(B(a,n,e),a.context_dictionary[a.context_wc]=a.context_dictSize++,a.context_w=String(a.context_c));for(""!==a.context_w&&B(a,n,e),a.value=2,o=0;o<a.context_numBits;o++)a.context_data_val=a.context_data_val<<1|1&a.value,j(a,n,e),a.value=a.value>>1;for(;;){if(a.context_data_val=a.context_data_val<<1,a.context_data_position==n-1){a.context_data.push(e(a.context_data_val));break}a.context_data_position++}return a.context_data.join("")}(t,15,(function(t){return m(t+32)}))+" "}function L(t){return null==t?"":""===t?null:function(t,n,e){for(var a,o,r=[],c={val:e(0),position:n,index:1},i=[],u=4,s=4,f=3,l="",h=0;h<3;h++)r[h]=h;switch(R(c,Math.pow(2,2),n,e)){case 0:o=m(R(c,Math.pow(2,8),n,e));break;case 1:o=m(R(c,Math.pow(2,16),n,e));break;case 2:return""}for(r[3]=o,a=o,i.push(o);;){if(c.index>t)return"";switch(o=R(c,Math.pow(2,f),n,e)){case 0:r[s++]=m(R(c,Math.pow(2,8),n,e)),o=s-1,u--;break;case 1:r[s++]=m(R(c,Math.pow(2,16),n,e)),o=s-1,u--;break;case 2:return i.join("")}if(0===u&&(u=Math.pow(2,f),f++),r[o])l=r[o];else{if(o!==s)return null;l=a+a.charAt(0)}i.push(l),r[s++]=a+l.charAt(0),a=l,0===--u&&(u=Math.pow(2,f),f++)}}(t.length,16384,(function(n){return t.charCodeAt(n)-32}))}function P(){try{return sessionStorage.setItem("testKey","testValue"),sessionStorage.removeItem("testKey"),!0}catch(t){return!1}}function U(t,n){return P()?sessionStorage.setItem(t,$(s(n)?JSON.stringify(n):n)):function(t,n){if(t&&void 0!==n){var e=g.hostname,a="https:"===g.protocol,r=n;s(n)&&(r=JSON.stringify(n));var c=-1===o.indexOf(e)?"; domain=".concat(i(e)):"",u=a?"; secure":"";document.cookie="".concat(t," = ").concat(r).concat(c).concat("; path=/").concat(u)}}(t,n)}function q(t){if(P()){var n=L(sessionStorage.getItem(t));try{return n=JSON.parse(n)}catch(t){return n}}return function(t){if(t){var n=decodeURIComponent(document.cookie),e="";return function(t,n){if(t&&t.length)for(var e=0;e<t.length;e+=1)if("function"==typeof n){var a=n.apply(t,[t[e],e]);if("boolean"==typeof a){if(a)continue;break}}}(n.split(";"),(function(n){var a="".concat(t,"="),o=n.indexOf(a);if(o>-1)return e=i(n.substring(o+a.length,n.length)),!1})),e}return""}(t)}var z={set:function(){return U.apply(this,arguments)},get:function(){return q.apply(this,arguments)}};function H(){this.handlers=[]}T(H.prototype,{getDataFromStore:function(t,n){return T(z.get("routeStore"))["".concat(n?"#":"").concat(t)]},setDataToStore:function(t,n,e){var a=T(z.get("routeStore"));if(a[t]&&(!e||f(e)&&0===x(e).length))return!1;var o={};return o["".concat(n?"#":"").concat(t)]=e,a=T({},a,o),z.set("routeStore",a)},contains:function(t){return!!this.handlers.filter(t).length},remove:function(t){this.handlers.splice(this.handlers.indexOf(t),1).length}});var J=new H;function F(){var t=g.hash.match(a);return T({},k(),t?T({},k(t[0])):{})}function K(t,n,e){var a=d(n),o=(n=n.substring(+a)).split("?")[0];x(e=T(e)).length&&J.setDataToStore(o,a,e);var r=w(t,n);return{hasMatch:x(r).length>0||p(n)&&(t===n||"*"===t),data:J.getDataFromStore(o,a),params:r}}function Q(t){t.type=t.hash?"hashchange":"popstate";var n=l(t.originalData,{});t.originalEvent=l(t.originalEvent,_(t.type,n)),delete t.originalData,function(t,n,e){e=T(e),J.handlers.forEach((function(a){if(a.eventName===t){var o=g[n.hash?"hash":"pathname"],r=K(a.isCaseInsensitive?a.route.toLowerCase():a.route,a.isCaseInsensitive?o.toLowerCase():o,e);r.hasMatch&&(!a.hash||a.hash&&n.hash)&&a.handler(T({},n,{data:r.data,params:r.params,query:F()}))}}))}("route.changed",t,n)}function V(t,n,e){var a=T({replaceMode:n,noTrigger:e},"string"==typeof t?{route:t}:t);if("string"==typeof a.route){var o=d(a.route),r=i(a.route).split("?"),c=r[0].substring(+o),u=b(i(r[1])||i(a.queryString));if(!p(c))throw new TypeError("Route string is not a pure route");J.setDataToStore(c,o,a.data);var s=function(t,n,e,a){e=i(e.substring(+("?"===e.charAt(0))));var o=a?g.search:"";return n?"".concat(g.pathname).concat(o,"#").concat(t).concat(e?"?".concat(e):""):"".concat(t).concat(o).concat(e?"".concat(o?"&":"?").concat(e):"")}(c,o,u,a.appendQuery);history[a.replaceMode?"replaceState":"pushState"]({data:a.data},a.title,s),a.noTrigger||Q({route:"".concat(o?"#":"").concat(c),hash:o})}}function G(t,n,e){var a="string"==typeof t&&0===t.indexOf("$$");if(v(t)&&(e=n,n=t,t="*"),c(t))return function(t,n){var e=this;J.contains((function(t){return t.prevHandler===n}))||G((function(a){v(n)&&t.indexOf("".concat(a.hash?"#":"").concat(a.route.substring(+a.hash)))>-1&&n.apply(e,[a])}),n)}(t,n);var o=d(t=t.substring(a?"$$".length:0));t=t.substring(+o),!J.contains((function(e){return e.handler===n&&e.route===t}))&&v(n)&&J.handlers.push({eventName:"route.changed",handler:n,prevHandler:e,route:t,hash:o,isCaseInsensitive:a}),(o?[g.hash]:[g.pathname,g.hash]).filter((function(t){return i(t)})).forEach((function(e){var o=d(e),r=K(a?t.toLowerCase():t,a?e.toLowerCase():e);if(r.hasMatch&&v(n)){var c=o?"hashchange":"popstate";n({originalEvent:_(c,r.data),route:e,hash:o,eventName:c,data:r.data,params:r.params,query:F(),isCaseInsensitive:a})}}))}function W(t,n){var e=J.handlers.length,a=c(t);if(a&&!n)return 0;var o=h(arguments);return 0===o.length?(J.handlers.length=0,e):(t=a?"*":t,J.handlers.forEach((function(e){var r=e.route===t,c=1===o.length;c&&"string"==typeof t&&!a||(c&&v(t)&&(n=t,t="*"),r=r&&(e.handler===n||e.prevHandler===n)),r&&J.remove(e)})),e-J.handlers.length)}function X(t,n){if(n=i(n),!Array.isArray(t))throw new TypeError("Provide a valid list of routes");for(var e=!1,a=0;a<t.length;a++){var o=i(t[a]);if(["*",n].indexOf(o)>-1||Object.keys(w(o,n)).length){e=!0;break}}return e}var Y={set:function(){return V.apply(this,arguments)},includes:function(){return X.apply(this,arguments)},list:function(){var t=[];return J.handlers.forEach((function(n){var e="".concat(n.hash?"#":"").concat(n.route);-1===t.indexOf(e)&&t.push(e)})),t}};function Z(){return G.apply(this,arguments)}window.addEventListener("".concat("popstate"),(function(t){var n="".concat(g.pathname).concat(g.hash).split("#"),e={originalEvent:t,originalData:T(t.state&&t.state.data)};Q(T({},e,{route:n[0],hash:!1})),n[1]&&Q(T({},e,{route:"#".concat(n[1]),hash:!0}))})),t.deparam=k,t.param=b,t.route=Z,t.routeIgnoreCase=function(t){"string"==typeof t&&Z.apply(this,["".concat("$$").concat(t),h(arguments).slice(1)])},t.routeParams=w,t.router=Y,t.unroute=function(){return W.apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0})}));

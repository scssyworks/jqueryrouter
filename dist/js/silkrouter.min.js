/**!
 * Router plugin for single page applications with routes
 * Released under MIT license
 * @name Silk router
 * @author Sachin Singh <contactsachinsingh@gmail.com>
 * @version 3.3.0
 * @license MIT
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("lzstorage")):"function"==typeof define&&define.amd?define(["exports","lzstorage"],n):n((t=t||self).silkrouter={},t.LZStorage)}(this,function(t,n){"use strict";n=n&&n.hasOwnProperty("default")?n.default:n;var w="hashchange",A="popstate",c="route.changed",i=/:[^\/]+/g,e=/^\/(?=[^?]*)/,r=/\?.+/,u=/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,a="$$";function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(n,e){null!=n&&"object"===s(n)&&Object.keys(n).forEach(function(t){e[t]=n[t]})}function S(){var t=0,n="object"!==s(arguments[0])||null==arguments[0]?{}:arguments[0];for(t=1;t<arguments.length;t++)o(arguments[t],n);return n}var f=new n({compression:!0}),j={getDataFromStore:function(t,n){return(f.get("routeStore")||{})["".concat(n?"#":"").concat(t)]},setDataToStore:function(t,n,e){var r=f.get("routeStore")||{};if(r[t]&&(!e||"object"===s(e)&&0===Object.keys(e).length))return!1;var a={};return a["".concat(n?"#":"").concat(t)]=e,r=S({},r,a),f.set("routeStore",r,!0)},handlers:[]},h=Array.isArray;function E(t){return"string"==typeof t?t.trim():""}function l(t){return t=E("".concat(t)),!(-1<["null","undefined",""].indexOf(t))&&!isNaN(Number(t))}function p(t,n){return void 0===t?n:t}function y(t){return Array.prototype.slice.call(t)}function O(t){return"string"==typeof t&&e.test(t)}var x=window.location;function v(t){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:x.pathname;if(i.test(t)){var e=new RegExp(t.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)")),r={};if(e.test(n)){i.lastIndex=0;var a=y(t.match(i)).map(function(t){return t.replace(u,"")}),o=y(n.match(e));o.shift(),a.forEach(function(t,n){r[t]=o[n]})}return r}return{}}function C(n){var e=[];return n&&"object"===s(n)?(Object.keys(n).forEach(function(t){!function e(r,a,o){if(o&&"object"===s(o)){var c=h(o);Object.keys(o).forEach(function(t){var n=c?"":t;e(r,"".concat(a,"[").concat(n,"]"),o[t])})}else-1<["string","number","boolean","undefined","object"].indexOf(s(o))&&r.push("".concat(encodeURIComponent(a),"=").concat(encodeURIComponent(o)))}(e,t,n[t])}),e.join("&")):"string"==typeof n?n:""}function g(t){return/\[/.test(t)}function d(t,e){var r=this;t=E(p(t,x.search)),e=p(e,!0),"?"===t.charAt(0)&&(t=t.replace("?",""));var n=t.split("&"),a={};return t&&n.forEach(function(t){var n=t.split("=").map(function(t){return decodeURIComponent(t)});g(n[0])?function t(n,e,r,a){a=p(a,!0);var o=n.match(/([^\[]+)\[([^\[]*)\]/)||[];if(3===o.length){var c=o[1],i=o[2];if(g(n=n.replace(/\[([^\[]*)\]/,"")))""===i&&(i="0"),n=n.replace(/[^\[]+/,i),t(n,e,r[c]=b(r[c],i).ob,a);else if(i){var u=b(r[c],i),s=u.ob,f=u.push;if(r[c]=s,f){var h={};h[i]=a?D(e):e,r[c].push(h)}else r[c][i]=a?D(e):e}else N([o[1],e],r,!0)}}.apply(r,[].concat(n).concat([a,e])):N.apply(r,[n,a,!1,e])}),a}function m(t,n){return void 0===t?n?[]:{}:n?t:function(t){var e={};return h(t)&&t.forEach(function(t,n){e[n]=t}),e}(t)}function b(t,n){return function(t){return null!=t&&!h(t)&&"[object Object]"===t.toString()}(t)?{ob:t}:h(t)||void 0===t?{ob:m(t,l(n))}:{ob:[t],push:null!==t}}function N(t,n,e,r){r=p(r,!0);var a=t[0],o=t[1];r&&(o=D(o)),a in n?(n[a]=h(n[a])?n[a]:[n[a]],n[a].push(o)):n[a]=e?[o]:o}function D(t){if(null==t)return"";if("string"!=typeof t)return t;if(l(t=E(t)))return+t;switch(t){case"null":return null;case"undefined":return;case"true":return!0;case"false":return!1;case"NaN":return NaN;default:return t}}function I(){return d.apply(this,arguments)}function k(t){var n=t.originalEvent,e=t.route,r=t.type,a=t.hash,o=t.originalData;q(c,{originalEvent:n,route:e,type:r,hash:a},o)}function L(){var t=I(x.search,!1),n={},e=x.hash.match(r);return e&&(n=S({},n,I(e[0],!1))),S({},t,n)}function M(t,n,e){var r="string"==typeof t?{route:t}:S({},t),a=r=S({},r,{replaceMode:n,noTrigger:e}),o=a.route,c=a.replaceMode,i=a.noTrigger,u=a.queryString,s=void 0===u?"":u,f=a.data,h=a.title,l=void 0===h?null:h,p=a.appendQuery;if("string"==typeof o){var y="#"===o.charAt(0)?1:0,v=E(o).split("?"),g=v[0],d=E(v[1]),m="".concat(c?"replace":"push","State");if(d=C(d||s),!O(g=g.substring(y)))throw new Error("Route string is not a pure route");j.setDataToStore(g,1==y,f);var b=function(t,n,e,r){return e=E(e.substring("?"===e.charAt(0)?1:0)),n?"".concat(x.pathname).concat(x.search,"#").concat(t).concat(e?"?".concat(e):""):r?"".concat(t).concat(x.search).concat(e?"&".concat(e):""):"".concat(t).concat(e?"?".concat(e):"")}(g,1==y,d,p);history[m]({data:f},l,b),i||k({originalEvent:{},route:"".concat(y?"#":"").concat(g),type:y?w:A,hash:1==y,originalData:{}})}}function R(u,s,t){var f=!1;if("function"==typeof u&&(t=s,s=u,u="*"),h(u))!function(o,c){var i=this;j.handlers.filter(function(t){return t.prevHandler===c}).length||R(function(){if("function"==typeof c){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=n[0],a=r.route;"#"===a.charAt(0)&&(a=a.substring(1)),-1<o.indexOf(a)?c.apply(i,n):-1<o.indexOf("#".concat(a))&&r.hash&&c.apply(i,n)}},c)}(u,s);else{0===u.indexOf(a)&&(f=!0,u=u.substring(a.length));var n="#"===u.charAt(0)?1:0;u=u.substring(n),j.handlers.filter(function(t){return t.handler===s&&t.route===u}).length||"function"!=typeof s||j.handlers.push({eventName:c,handler:s,prevHandler:t,route:u,hash:1==n,isCaseInsensitive:f});var e=x.pathname,r=x.hash;(1==n?[r]:[e,r]).filter(function(t){return E(t)}).forEach(function(t){var n=u,e=t;f&&(n=n.toLowerCase(),e=e.toLowerCase());var r="#"===t.charAt(0)?1:0,a=T(n,e),o=a.hasMatch,c=a.data,i=a.params;o&&"function"==typeof s&&s({route:t,hash:1==r,eventName:1==r?w:A,data:c,params:i,query:L(),isCaseInsensitive:f})})}}function T(t,n,e){e=S(e);var r="#"===n.charAt(0);r&&(n=n.substring(1));var a=n.split("?")[0];Object.keys(e).length&&j.setDataToStore(a,r,e);var o=j.getDataFromStore(a,r),c=v(t,n);return{hasMatch:0<Object.keys(c).length||O(n)&&(t===n||"*"===t),data:o,params:c}}function q(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(i,u,s){s=S(s);var f=u.hash,h=x.hash,l=x.pathname;j.handlers.forEach(function(t){if(t.eventName===i){var n=t.route,e=f?h:l;t.isCaseInsensitive&&(n=n.toLowerCase(),e=e.toLowerCase());var r=T(n,e,s),a=r.hasMatch,o=r.data,c=r.params;a&&(!t.hash||t.hash&&f)&&t.handler(S({},u,{data:o,params:c,query:L()}))}})}.apply(this,n)}var z={api:{trigger:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return q.apply(this,n)},extractParams:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return v.apply(this,n)},toQueryString:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return C.apply(this,n)}},set:function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return M.apply(this,n)}};function P(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return R.apply(this,n)}window.addEventListener("".concat(A),function(t){var n="".concat(x.pathname).concat(x.hash).split("#"),e=n[0],r=n[1],a={};if(t.state){var o=t.state.data;o&&(a=o)}k({originalEvent:t,route:e,type:t.type,hash:!1,originalData:a}),r&&k({originalEvent:t,route:"#".concat(r),type:w,hash:!0,originalData:a})}),t.deparam=I,t.param=C,t.route=P,t.routeIgnoreCase=function(t){if("string"==typeof t){for(var n=arguments.length,e=new Array(1<n?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];P.apply(this,["".concat(a).concat(t)].concat(e))}},t.routeParams=v,t.router=z,t.unroute=function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];return function(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];var r=n[0],a=n[1],o=j.handlers.length,c=!1;return 0===n.length&&(j.handlers.length=0),h(r)&&(r="*",c=!0),j.handlers=j.handlers.filter(function(t){return 1!==n.length||"string"!=typeof n[0]||c?(1===n.length&&"function"==typeof n[0]&&(a=n[0],r="*"),!(t.route===r&&(t.handler===a||t.prevHandler===a))):t.route!==r}),o>j.handlers.length}.apply(this,n)},Object.defineProperty(t,"__esModule",{value:!0})});

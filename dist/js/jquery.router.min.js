!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery"),require("deparam.js")):"function"==typeof define&&define.amd?define(["exports","jquery","deparam.js"],t):t((e=e||self).jqueryrouter={},e.jQuery,e.deparam)}(this,function(e,t,a){"use strict";function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t=t&&t.hasOwnProperty("default")?t.default:t,a=a&&a.hasOwnProperty("default")?a.default:a;var o={handlers:[]},c=history&&history.pushState,l=window.location,f={noTrigger:!1},u={pathname:/^\/(?=[^?]*)/,routeparams:/:[^\/]+/g,hashQuery:/\?.+/},d={routeChanged:"routeChanged",hashchange:"hashchange",popstate:"popstate"},n={invalidPath:"Path is invalid"};function h(t,r){null!=t&&"object"===p(t)&&Object.keys(t).forEach(function(e){r[e]=t[e]})}function y(e){var t=0,r="object"!==p(e)||null==e?{}:e;for(t=1;t<arguments.length;t++)h(arguments[t],r);return r}function i(e){return Array.prototype.slice.call(e)}function r(e,t){var r=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];if(f.noTrigger&&t===d.hashchange)f.noTrigger=!1;else{var a=y({},f.currentData);r&&delete f.currentData,j.events.trigger(d.routeChanged,{data:y({},r?a:{},{eventType:t,hash:!!r,route:e,isInit:n})})}}function s(e){var t=!(0<arguments.length&&void 0!==e)||e,r=a(l.search,t),n={};return l.hash.match(u.hashQuery)&&(n=a(l.hash.match(u.hashQuery)[0],t)),y({},r,n)}function g(e,t,r){if(function(e){return"string"==typeof e&&u.pathname.test(e)}(e))return function(e,t,r){return t||r?"string"==typeof t?(t=t.trim())&&r?"".concat(e).concat(l.search,"&").concat(t.replace("?","")):t?"".concat(e,"?").concat(t.replace("?","")):e:void 0:e}(e,t,r);throw new TypeError(n.invalidPath)}function m(e){return e.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g,"")}function v(e,t,r){if(~t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),u.routeparams.lastIndex=0,!u.routeparams.test(e))return e===t||"*"===e;r.params={};var n=new RegExp(e.replace(/\//g,"\\/").replace(/:[^\/\\]+/g,"([^\\/]+)"));if(n.test(t)){u.routeparams.lastIndex=0;var a=i(e.match(u.routeparams)).map(m),o=i(t.match(n));return o.shift(),a.forEach(function(e,t){r.params[e]=o[t]}),!0}return!1}var b,j={events:y({trigger:function(e,t){return function(t,r){(r=y(r)).data=y(r.data);var e=r.data,n=e.hash,a=e.isInit;o.handlers.forEach(function(e){e.eventName===t&&(!c||n||!v(e.route,l.pathname,r)||a&&e.called?n&&(l.hash||c||!v(e.route,l.pathname,r)?!v(e.route,l.hash.substring(1),r)||a&&e.hashCalled||(e.hashCalled=!0,e.handler(r.data,r.params,s(!1))):(f.data=r.data,l.replace("#"+l.pathname))):(e.called=!0,e.handler(r.data,r.params,s(!1))))})}.apply(this,[e,t])}},d),init:function(){var e={eventType:c?d.popstate:d.hashchange,hash:!c,route:c?l.pathname:l.hash,isInit:!0};this.events.trigger(d.routeChanged,{data:e}),l.hash&&t(window).trigger(d.hashchange,[!0])},set:function(){return function(e,t,r){if(e){var n=null,a="",o="",u=!1,h=!1,i=t?"replaceState":"pushState",s={};f.noTrigger=r,"object"===p(e)?(s=e.data,n=e.title,a=e.route,o=e.queryString,u=e.appendQuery):"string"==typeof e&&(a=e),"#"===a.charAt(0)&&(h=!0,a=a.replace("#","")),c&&!h?(history[i](f.data,n,g(a,o,u)),r||(s=y({},s,{eventType:d.popstate,hash:!1,route:a}),j.events.trigger(d.routeChanged,{data:s}))):(f.currentData=s,t?l.replace("#"+g(a,o,u)):l.hash=g(a,o,u))}}.apply(this,arguments)},historySupported:c};function w(){return function(r,n){var a=this;"function"==typeof r&&(n=r,r="*"),o.handlers.filter(function(e){var t=e.originalHandler===n&&e.route===r;return a&&(t=t&&e.element===a),t}).length||o.handlers.push({eventName:d.routeChanged,originalHandler:n,handler:n.bind(this),element:this,route:r})}.apply(this,arguments)}function S(){return function(t,r){var n=arguments.length;0===n.length&&(o.handlers.length=0),o.handlers=o.handlers.filter(function(e){return 1===n.length&&"string"==typeof n[0]?e.route!==t:(1===n.length&&"function"==typeof n[0]&&(r=n[0],t="*"),!(e.route===t&&e.handler===r))})}.apply(this,arguments)}"function"==typeof t&&(t.route=t.prototype.route=w,t.unroute=t.prototype.unroute=S,t.router=j),(b=t(window)).on(d.popstate,function(e){r.apply(this,[l.pathname,e.type])}),b.on(d.hashchange,function(e,t){r.apply(this,[l.hash,e.type,!0,t])}),e.route=w,e.router=j,e.unroute=S,Object.defineProperty(e,"__esModule",{value:!0})});

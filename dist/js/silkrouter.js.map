{"version":3,"file":"silkrouter.js","sources":["../../src/js/utils/constants.js","../../src/js/utils/libs.js","../../src/js/silkrouter.js"],"sourcesContent":["/**\n * Router constants\n */\nexport const HASH_CHANGE = 'hashchange';\nexport const POP_STATE = 'popstate';\nexport const ROUTE_CHANGED = 'route.changed';\nexport const REG_ROUTE_PARAMS = /:[^\\/]+/g;\nexport const REG_PATHNAME = /^\\/(?=[^?]*)/;\nexport const REG_HASH_QUERY = /\\?.+/;\nexport const INVALID_ROUTE = 'Route string is not a pure route';","import LZStorage from 'lzstorage';\n\n// Object containing a map of attached handlers\nconst store = new LZStorage({\n    compression: true\n});\nexport const libs = {\n    getDataFromStore(path, isHash) {\n        const paths = store.get('routeStore') || {};\n        return paths[`${isHash ? '#' : ''}${path}`];\n    },\n    setDataToStore(path, isHash, data) {\n        let paths = store.get('routeStore') || {};\n        paths = {\n            ...paths,\n            [`${isHash ? '#' : ''}${path}`]: data\n        };\n        return store.set('routeStore', paths, true);\n    },\n    handlers: []\n};","/**!\n * Silk router plugin\n * This file contains SPA router methods to handle routing mechanism in single page applications (SPA). Supported versions IE10+, Chrome, Safari, Firefox\n *\n * @project      Silk Routing Plugin\n * @date         2019-05-05\n * @author       Sachin Singh <ssingh.300889@gmail.com>\n * @dependencies deparam.js, lzstorage\n * @version      3.0.0-beta.4\n */\n\nimport deparam from 'deparam.js';\nimport { POP_STATE, HASH_CHANGE, ROUTE_CHANGED, REG_ROUTE_PARAMS, INVALID_ROUTE, REG_HASH_QUERY, REG_PATHNAME } from './utils/constants';\nimport { libs } from './utils/libs';\n\n/**\n * Trims leading/trailing special characters\n * @param {string} param Parameters\n */\nfunction sanitize(str) {\n    return str.replace(/^([^a-zA-Z0-9]+)|([^a-zA-Z0-9]+)$/g, \"\");\n}\n\n/**\n * Triggers \"route.changed\" event\n */\nfunction triggerRoute(route, eventType, hash = false, originalData = {}) {\n    router.api.trigger(\n        ROUTE_CHANGED,\n        {\n            route,\n            eventType,\n            hash\n        },\n        originalData\n    );\n}\n\n/**\n * Checks if given route is valid\n * @param {string} route Route string\n */\nfunction isValidRoute(route) {\n    if (typeof route !== \"string\") {\n        return false;\n    };\n    return REG_PATHNAME.test(route);\n}\n\n/**\n * Adds a query string\n * @param {string} route Route string\n * @param {string} qString Query string\n * @param {boolean} appendQString Append query string flag\n */\nfunction resolveQuery(route = '', isHash = false, queryString = '', append = false) {\n    queryString = queryString.charAt(0) === '?' ? queryString.substring(1).trim() : queryString.trim();\n    if (!isHash) {\n        if (append) {\n            if (queryString) {\n                return `${route}${location.search}&${queryString}`;\n            }\n            return `${route}${location.search}`;\n        } else if (queryString) {\n            return `${route}?${queryString}`;\n        }\n        return route;\n    } else if (queryString) {\n        return `${location.pathname}${location.search}#${route}?${queryString}`;\n    }\n    return `${location.pathname}${location.search}#${route}`;\n}\n\n/**\n * Converts current query string into an object\n */\nfunction getQueryParams() {\n    const qsObject = deparam(window.location.search);\n    let hashStringParams = {};\n    if (window.location.hash.match(REG_HASH_QUERY)) {\n        hashStringParams = {\n            ...hashStringParams,\n            ...deparam(window.location.hash.match(REG_HASH_QUERY)[0])\n        };\n    }\n    return {\n        ...qsObject,\n        ...hashStringParams\n    };\n}\n\n/**\n * Set route for given view\n * @param {string|object} oRoute Route string or object\n * @param {boolean} replaceMode Replace mode\n * @param {boolean} noTrigger Do not trigger handler\n */\nfunction execRoute(route = {}, replaceMode = false, noTrigger = false) {\n    let routeObject = typeof route === 'string' ? { route } : {\n        ...route\n    };\n    routeObject = {\n        ...routeObject,\n        replaceMode,\n        noTrigger\n    };\n    const { route: sroute, replaceMode: rm, noTrigger: nt, queryString: qs = '', data, title = null, appendQuery } = routeObject;\n    if (typeof sroute === 'string') {\n        const isHash = sroute.charAt(0) === '#' ? 1 : 0;\n        let [pureRoute, queryString = ''] = sroute.trim().split('?');\n        const routeMethod = `${rm ? 'replace' : 'push'}State`;\n        queryString = queryString || qs;\n        pureRoute = pureRoute.substring(isHash);\n        if (isValidRoute(pureRoute)) {\n            libs.setDataToStore(pureRoute, isHash === 1, data);\n            const completeRoute = resolveQuery(pureRoute, isHash === 1, queryString, appendQuery);\n            history[routeMethod]({ data }, title, completeRoute);\n            if (!nt) {\n                triggerRoute(\n                    `${isHash ? '#' : ''}${pureRoute}`,\n                    (isHash ? HASH_CHANGE : POP_STATE),\n                    (isHash === 1)\n                );\n            }\n        } else {\n            throw new Error(INVALID_ROUTE);\n        }\n    }\n}\n\n/**\n * Attaches a route handler function\n * @param {string} route Route string\n * @param {function} handler Callback function\n */\nfunction bindRoute(route, handler) {\n    let originalHandler = handler;\n    const element = this;\n    if (typeof handler === 'function') {\n        handler = handler.bind(this);\n    }\n    // Resolve generic route\n    if (typeof route === 'function') {\n        originalHandler = route;\n        handler = route.bind(this);\n        route = '*';\n    }\n    // Check existence\n    const exists = libs.handlers.filter(ob => {\n        let test = (ob.originalHandler === originalHandler && ob.route === route);\n        if (this) {\n            test = test && ob.element === this;\n        }\n        return test;\n    }).length;\n    // Attach handler\n    if (!exists && typeof handler === 'function') {\n        libs.handlers.push({\n            eventName: ROUTE_CHANGED,\n            originalHandler,\n            handler,\n            element,\n            route\n        });\n    }\n    // Execute handler if matches current route (Replaces init method in version 2.0)\n    const { pathname, hash } = window.location;\n    [pathname, hash].forEach(currentPath => {\n        const isHash = currentPath.charAt(0) === '#' ? 1 : 0;\n        const { hasMatch, data, params } = testRoute(route, currentPath);\n        if (hasMatch && typeof handler === 'function') {\n            handler({\n                route: currentPath,\n                hash: isHash === 1,\n                eventName: isHash ? HASH_CHANGE : POP_STATE,\n                data,\n                params,\n                query: getQueryParams()\n            });\n        }\n    });\n}\n\n/**\n * Unbinds route handlers\n * @param {string} route Route string\n * @param {function} handler Callback function\n */\nfunction unbindRoute(route, handler) {\n    const args = arguments;\n    if (args.length === 0) {\n        libs.handlers.length = 0;\n    }\n    libs.handlers = libs.handlers.filter(ob => {\n        if (args.length === 1 && typeof args[0] === 'string') {\n            return ob.route !== route;\n        }\n        // Check for generic route\n        if (args.length === 1 && typeof args[0] === 'function') {\n            handler = args[0];\n            route = '*'; // Generic route\n        }\n        return !(ob.route === route && ob.handler === handler);\n    });\n}\n\n\n/**\n * Compares route with current URL\n * @param {string} route Route string\n * @param {string} url Current url\n * @param {object} params Parameters\n */\nfunction testRoute(route, url, originalData = {}) {\n    const isHash = url.charAt(0) === '#';\n    if (isHash) {\n        url = url.substring(1);\n    }\n    const [path] = url.split('?');\n    if (!!Object.keys(originalData).length) {\n        libs.setDataToStore(path, isHash, originalData); // Sync store with event data.\n    }\n    const data = { ...libs.getDataFromStore(path, isHash) };\n    const params = {};\n    let hasMatch = false;\n    REG_ROUTE_PARAMS.lastIndex = 0;\n    if (REG_ROUTE_PARAMS.test(route)) {\n        const pathRegex = new RegExp(route.replace(/\\//g, \"\\\\/\").replace(/:[^\\/\\\\]+/g, \"([^\\\\/]+)\"));\n        if (pathRegex.test(url)) {\n            hasMatch = true;\n            REG_ROUTE_PARAMS.lastIndex = 0;\n            const keys = [...route.match(REG_ROUTE_PARAMS)].map(sanitize);\n            const values = [...url.match(pathRegex)];\n            values.shift();\n            keys.forEach((key, index) => {\n                params[key] = values[index];\n            });\n        }\n    } else {\n        hasMatch = isValidRoute(url) && ((route === url) || (route === '*'));\n    }\n    return {\n        hasMatch,\n        data,\n        params\n    };\n}\n\n/**\n * Triggers a router event\n * @param {string} eventName Name of route event\n * @param {object} params Parameters\n */\nfunction execListeners(eventName, routeConfig, originalData = {}) {\n    const { hash: isHash } = routeConfig;\n    const { hash, pathname } = window.location;\n    libs.handlers.forEach(ob => {\n        if (ob.eventName === eventName) {\n            const { hasMatch, data, params } = testRoute(\n                ob.route,\n                (isHash ? hash : pathname),\n                originalData\n            );\n            if (hasMatch) {\n                ob.handler({\n                    ...routeConfig,\n                    data,\n                    params,\n                    query: getQueryParams()\n                });\n            }\n        }\n    });\n}\n\n/**\n * Initializes router events\n */\nfunction initRouterEvents() {\n    window.addEventListener(`${POP_STATE}`, function (e) {\n        const completePath = `${location.pathname}${location.hash}`;\n        const [pathname, hashstring] = completePath.split('#');\n        let originalData = {};\n        if (e.state) {\n            const { data } = e.state;\n            if (data) {\n                originalData = data;\n            }\n        }\n        triggerRoute(pathname, e.type, false, originalData);\n        if (hashstring) {\n            triggerRoute(`#${hashstring}`, HASH_CHANGE, true, originalData);\n        }\n    });\n}\n\nconst router = {\n    // Events object\n    api: {\n        /**\n         * Triggers a custom route event\n         */\n        trigger() {\n            return execListeners.apply(this, arguments);\n        }\n    },\n    /**\n     * Sets a route url\n     * @param {string|object} route Route object or URL\n     * @param {boolean} replaceMode Flag to enable replace mode\n     * @param {boolean} noTrigger Flag to disable handler while changing route\n     */\n    set() {\n        return execRoute.apply(this, arguments);\n    }\n}\n\n/**\n * Attaches a route handler\n * @param {string|function} route Route string or handler function (in case of generic route)\n * @param {function} handler Handler function\n */\nfunction route() {\n    return bindRoute.apply(this, arguments);\n}\n\n/**\n * Detaches a route handler\n * @param {string|function} route Route string or handler function (in case of generic route)\n * @param {function} handler Handler function\n */\nfunction unroute() {\n    return unbindRoute.apply(this, arguments);\n}\n\ninitRouterEvents();\n\nexport { router, route, unroute };"],"names":["HASH_CHANGE","POP_STATE","ROUTE_CHANGED","REG_ROUTE_PARAMS","REG_PATHNAME","REG_HASH_QUERY","INVALID_ROUTE","store","LZStorage","compression","libs","getDataFromStore","path","isHash","paths","get","setDataToStore","data","set","handlers","sanitize","str","replace","triggerRoute","route","eventType","hash","originalData","router","api","trigger","isValidRoute","test","resolveQuery","queryString","append","charAt","substring","trim","location","search","pathname","getQueryParams","qsObject","deparam","window","hashStringParams","match","execRoute","replaceMode","noTrigger","routeObject","sroute","rm","nt","qs","title","appendQuery","split","pureRoute","routeMethod","completeRoute","history","Error","bindRoute","handler","originalHandler","element","bind","exists","filter","ob","length","push","eventName","forEach","currentPath","testRoute","hasMatch","params","query","unbindRoute","args","arguments","url","Object","keys","lastIndex","pathRegex","RegExp","map","values","shift","key","index","execListeners","routeConfig","initRouterEvents","addEventListener","e","completePath","hashstring","state","type","apply","unroute"],"mappings":"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"}